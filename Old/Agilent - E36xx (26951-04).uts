# Поверяемый прибор: Меры напряжения и тока E3640A, E3641A, E3642A, E3643A, E3644A, E3645A, E3646A, E3647A, E3648A, E3649A
# Поверяемые параметры: (VDC), (IDC), (VDC_izm), (IDC_izm),(INSTB_U_Upit), (INSTB_I-Upit), (INSTB_U_Inagr), (INSTB_I_Unagr)
#       
#
# Поверяемые параметры: 
#           погрешность формирования выходного напряжения (VDC) и силы выходного тока (IDC)
#           пульсации выходного напряжения (PVDC) и выходного тока (PIDC)
#           нестабильности при изменении напряжения питающей сети выходного напряжения (INSTB_U_Upit) и тока (INSTB_I_Upit) 
#           нестабильность выходного напряжения при изменении тока нагрузки (INSTB_U_Inagr)
#           нестабильность выходного тока при изменении выходного напряжения (INSTB_I_Unagr)   
#           
#
####################################################################################################################################################### 
###############################################################  S   T   A   R   T   ##################################################################
#######################################################################################################################################################
Tree Enable Main  
#/ Скрипт для поверки приборов: меры напряжения и тока E3640A, E3641A, E3642A, E3643A, E3644A, E3645A, E3646A, E3647A, E3648A, E3649A
#

Call Main       #uhesh(Main)
#F/ Настройка
function Main
#    Выбор поверяемого прибора
call MODE_PRIBOR_CHOICE                         

#    Выбор нагрузки
call LOAD_CHOISE                                             

#    Выбор типа поверки
call MODE_POVERKA_CHOICE                         

#    Установка стандартных значений для данного скрипта  (DEFINE)
call START_DEFINE                                        

#    Данные для отчета:
call MODE_INPUT_TABLE                    

#    Внешний осмотр поверяемого устройства
Call VISUAL_CHECK                                        

#    Опробование устройства
Call OPROBIROVANIE                                        
endfunction


#####################################################################################################################################################################
##############################################################   D   O   T   S   ####################################################################################
#####################################################################################################################################################################

################################################### КАНАЛ 1 ########################################################################################################

####################################
#/ Диапазон выходных величин "High"     Канал 1
####################################

##################################################################################################################################################################
#/     Определение абсолютной погрешности формирования выходного постоянного напряжения.           
##################################################################################################################################################################

#									Диапазон;			Напряжение СИ от U_max, В;			Ток СИ от Imax, А;			Ток нагрузки от Imax, А;			Интервал жидания, с;     
call VDC_H						1					1										1								0,8									5k
call VDC_H						1					0,8										1								0,8									5k
call VDC_H						1					0,6										1								0,8									5k
call VDC_H						1					0,4										1								0,8									5k
call VDC_H						1					0,2										1								0,8									5k

##################################################################################################################################################################
#/     Определение абсолютной погрешности измерения выходного постоянного напряжения.           
##################################################################################################################################################################

#									Диапазон;			Напряжение СИ от U_max, В;			Ток СИ от Imax, А;			Ток нагрузки от Imax, А;			Интервал жидания, с;     
call VDC_izm_H					1					1										1								0									5k
call VDC_izm_H					1					0,8										1								0									5k
call VDC_izm_H					1					0,6										1								0									5k
call VDC_izm_H					1					0,4										1								0									5k
call VDC_izm_H					1					0,2										1								0									5k

###################################################################################################################################################################
#/     Определение нестабильности выходного напряжения при изменении напряжения питающей сети.     #uhesh(INSTB_U_Upit_H)      
###################################################################################################################################################################

#									Диапазон;			Напряжение СИ от U_max, В;			Ток СИ от Imax, А;			Ток нагрузки от Imax, А;			Интервал жидания, с;				Напряжение питания от U_pit, В;     
call INSTB_U_Upit_H				1					1										0,9								0,8									5k									1                                             

###################################################################################################################################################################
#/     Определение нестабильности выходного напряжения при изменении тока нагрузки.                     
###################################################################################################################################################################

#									Диапазон;			Напряжение СИ от U_max, В;			Ток СИ от Imax, А;			Ток нагрузки от Imax, А;			Интервал жидания, с;				Выходной ток от I_max 2, A;
call INSTB_U_Inagr_H				1					1										0,9								0,8									5k									0                                  

###################################################################################################################################################################
#/     Определение абсолютной погрешности формирования силы выходного тока.                
###################################################################################################################################################################

#									Диапазон;			Ток СИ от Imax, А;			Напряжение СИ от U_max, В;			Ток нагрузки от Imax, А;			Интервал жидания, с;     
call IDC_H						1					1										1								1,1									5k
call IDC_H						1					0,8										1								1,1									5k
call IDC_H						1					0,6										1								1,1									5k
call IDC_H						1					0,4										1								1,1									5k
call IDC_H						1					0,2										1								1,1									5k

###################################################################################################################################################################
#/     Определение абсолютной погрешности измерения силы выходного тока.                
###################################################################################################################################################################

#									Диапазон;			Ток СИ от Imax, А;			Напряжение СИ от U_max, В;			Ток нагрузки от Imax, А;			Интервал жидания, с;
call IDC_izm_H					1					1										1								1,1									5k
call IDC_izm_H					1					0,8										1								1,1									5k
call IDC_izm_H					1					0,6										1								1,1									5k
call IDC_izm_H					1					0,4										1								1,1									5k
call IDC_izm_H					1					0,2										1								1,1									5k

###################################################################################################################################################################
#/ Определение нестабильности выходного тока при изменении напряжения питающей сети.     #uhesh(INSTB_I_Upit_H)                    
###################################################################################################################################################################

#									Диапазон;			Ток СИ от Imax, А;			Напряжение СИ от U_max, В;			Ток нагрузки от Imax, А;			Интервал жидания, с;				Напряжение питания от U_pit, В;
call INSTB_I_Upit_H				1					1										1								1,1									5k									1                                        

###################################################################################################################################################################
#/     Определение нестабильности выходного тока при изменении выходного напряжения.                    
###################################################################################################################################################################

#									Диапазон;			Ток СИ от Imax, А;			Напряжение СИ от U_max, В;			Ток нагрузки от Imax, А;			Интервал жидания, с;				Выходное напряжение от U_max 2, В;
call INSTB_I_Unagr_H				1					1										1								1,1									5k									0,5                                        

####################################
#/ Диапазон выходных величин "Low"     Канал 1
####################################

##################################################################################################################################################################
#/     Определение абсолютной погрешности формирования выходного постоянного напряжения.           
##################################################################################################################################################################

#                    Диапазон;      Напряжение СИ от U_max, В;          Ток СИ от Imax, А;          Ток нагрузки от Imax, А;     Интервал жидания, с;     
call VDC_L                         1               1                          1                           	 0,8                   		    5k
call VDC_L                         1               0,8                        1                              0,8                             5k
call VDC_L                         1               0,6                        1                              0,8                             5k
call VDC_L                         1               0,4                        1                              0,8                             5k
call VDC_L                         1               0,2                        1                              0,8                             5k

##################################################################################################################################################################
#/     Определение абсолютной погрешности измерения выходного постоянного напряжения.           
##################################################################################################################################################################

#                    Диапазон;           Напряжение СИ от U_max, В; Ток СИ от Imax, А;      Ток нагрузки от Imax, А;     Интервал жидания, с;     call VDC_izm_L               1      	               			   0,2   		1											    0            		           5k
call VDC_izm_L               1      	               			   0,4   		1												0                             5k
call VDC_izm_L               1      	               			   0,6   		1												0                             5k
call VDC_izm_L               1      	               			   0,8   		1												0                             5k
call VDC_izm_L               1      	               			  1      		1												0                             5k
###################################################################################################################################################################
#/     Определение нестабильности выходного напряжения при изменении напряжения питающей сети.     #uhesh(INSTB_U_Upit_L)      
###################################################################################################################################################################

#                         Диапазон;     Напряжение СИ от U_max, В;          Ток СИ от Imax, А;          Ток нагрузки от Imax, А;     Интервал жидания, с;     Напряжение питания от U_pit, В;     
call INSTB_U_Upit_L        1     					     1               		    0,9                                0,8                    5k                              1                                             

###################################################################################################################################################################
#/     Определение нестабильности выходного напряжения при изменении тока нагрузки.                     
###################################################################################################################################################################

#                         Диапазон;     Напряжение СИ от U_max, В;          Ток СИ от Imax, А;          Ток нагрузки от Imax, А;     Интервал жидания, с;     Выходной ток от I_max 2, В;
call INSTB_U_Inagr_L          1     		     1                                   0,1                              0,8                          5k                                   0                                   

###################################################################################################################################################################
#/     Определение абсолютной погрешности формирования силы выходного тока.                
###################################################################################################################################################################

#                         Диапазон;     Ток СИ от Imax, А;          Напряжение СИ от U_max, В;          Ток нагрузки от Imax, А;     Интервал жидания, с;     
call IDC_L                         1               0                                   1                                             1,1                    5k
call IDC_L                         1               0,2                                   1                                        1,1                         5k
call IDC_L                         1               0,4                                   1                                        1,1                         5k
call IDC_L                         1               0,6                                   1                                        1,1                         5k
call IDC_L                         1               0,8                                   1                                        1,1                         5k
call IDC_L                         1               1                                   1                                             1,1                    5k

###################################################################################################################################################################
#/     Определение абсолютной погрешности измерения силы выходного тока.                
###################################################################################################################################################################

#                         Диапазон;     Ток СИ от Imax, А;          Напряжение СИ от U_max, В;          Ток нагрузки от Imax, А;     Интервал жидания, с;     
call IDC_izm_L               1      				       			    1                  1       1,1                 				        5k
call IDC_izm_L               1      				       			    0,8                1         1,1                                   5k
call IDC_izm_L               1      				       			    0,6                1         1,1                                   5k
call IDC_izm_L               1      				       			    0,4                1         1,1                                   5k
call IDC_izm_L               1      				       			    0,2                1         1,1                                   5k

###################################################################################################################################################################
#/ Определение нестабильности выходного тока при изменении напряжения питающей сети.     #uhesh(INSTB_I_Upit_L)                    
###################################################################################################################################################################

#                         Диапазон;          Ток СИ от Imax, А;          Напряжение СИ от U_max, В;           Ток нагрузки от Imax, А;     Интервал жидания, с;     Напряжение питания от U_pit, В;
call INSTB_I_Upit_L         1               1                                   1                                             1,1                                   5k                            1                                        

###################################################################################################################################################################
#/     Определение нестабильности выходного тока при изменении выходного напряжения.                    
###################################################################################################################################################################

#                         Диапазон;     Ток СИ от Imax, А;          Напряжение СИ от U_max, В;          Ток нагрузки от Imax, А;     Интервал жидания, с;     Выходное напряжение от U_max 2, В;
call INSTB_I_Unagr_L        1               1                                   1                                             1,1                                   5k                            0,5                                   

################################################### КАНАЛ 2 ########################################################################################################

####################################
#/ Диапазон выходных величин "High"     Канал 2
####################################

##################################################################################################################################################################
#/     Определение абсолютной погрешности формирования выходного постоянного напряжения.                #uhesh(VDC_H_CH2)
##################################################################################################################################################################

#                                   Диапазон;      Напряжение СИ от U_max, В;          Ток СИ от Imax, А;          Ток нагрузки от Imax, А;     Интервал жидания, с;     
call VDC_H_CH2                    2                    1                                             1                                   0,8                         5k
call VDC_H_CH2                    2                    0,8                                             1                              0,8                              5k
call VDC_H_CH2                    2                    0,6                                             1                              0,8                              5k
call VDC_H_CH2                    2                    0,4                                             1                              0,8                              5k
call VDC_H_CH2                    2                    0,2                                             1                              0,8                              5k

##################################################################################################################################################################
#/     Определение абсолютной погрешности измерения выходного постоянного напряжения.                #uhesh(VDC_izm_H_CH2)
##################################################################################################################################################################

#                                   Диапазон;      Напряжение СИ от U_max, В;          Ток СИ от Imax, А;          Ток нагрузки от Imax, А;     Интервал жидания, с;     
call VDC_izm_H_CH2               2                                                     1                         1                 0                         5k
call VDC_izm_H_CH2               2                                                     0,8                       1                  0                              5k
call VDC_izm_H_CH2               2                                                     0,6                       1                  0                              5k
call VDC_izm_H_CH2               2                                                     0,4                       1                  0                              5k
call VDC_izm_H_CH2               2                                                     0,2                       1                  0                              5k

###################################################################################################################################################################
#/     Определение нестабильности выходного напряжения при изменении напряжения питающей сети.     #uhesh(INSTB_U_Upit_H_CH2)      
###################################################################################################################################################################

#                                   Диапазон;     Напряжение СИ от U_max, В;          Ток СИ от Imax, А;          Ток нагрузки от Imax, А;     Интервал жидания, с;     Напряжение питания от U_pit, В;     
call INSTB_U_Upit_H_CH2       2               1                                             0,9                                   0,8                                   5k                              1                                             

###################################################################################################################################################################
#/     Определение нестабильности выходного напряжения при изменении тока нагрузки.                     #uhesh(INSTB_U_Inagr_H_CH2)
###################################################################################################################################################################

#                                   Диапазон;     Напряжение СИ от U_max, В;          Ток СИ от Imax, А;          Ток нагрузки от Imax, А;     Интервал жидания, с;     Выходной ток от I_max 2, В;
call INSTB_U_Inagr_H_CH2      			    2          				     1                   0,9                                  0,8                                   5k                         0                                  

###################################################################################################################################################################
#/     Определение абсолютной погрешности формирования силы выходного тока.                               #uhesh(IDC_H_CH2)
###################################################################################################################################################################

#                                   Диапазон;     Ток СИ от Imax, А;          Напряжение СИ от U_max, В;          Ток нагрузки от Imax, А;     Интервал жидания, с;     
call IDC_H_CH2                    2                                  1     							         	 1                                            1,1                         5k
call IDC_H_CH2                    2                                  0,8  							             1                                        1,1                              5k
call IDC_H_CH2                    2                                  0,6  							             1                                        1,1                              5k
call IDC_H_CH2                    2                                  0,4  							             1                                        1,1                              5k
call IDC_H_CH2                    2                                  0,2  							             1                                        1,1                              5k

###################################################################################################################################################################
#/     Определение абсолютной погрешности измерения силы выходного тока.                               #uhesh(IDC_izm_H_CH2)
###################################################################################################################################################################

#                                   Диапазон;     Ток СИ от Imax, А;          Напряжение СИ от U_max, В;          Ток нагрузки от Imax, А;     Интервал жидания, с;     
call IDC_izm_H_CH2               2           1      						 1                                                                           1,1                                   5k
call IDC_izm_H_CH2               2           0,8   						 1                                                                           1,1                                   5k
call IDC_izm_H_CH2               2           0,6   						 1                                                                           1,1                                   5k
call IDC_izm_H_CH2               2           0,4   						 1                                                                           1,1                                   5k
call IDC_izm_H_CH2               2           0,2   						 1                                                                           1,1                                   5k

###################################################################################################################################################################
#/ Определение нестабильности выходного тока при изменении напряжения питающей сети.     #uhesh(INSTB_I_Upit_H_CH2)                    
###################################################################################################################################################################

#                                   Диапазон;          Ток СИ от Imax, А;          Напряжение СИ от U_max, В;           Ток нагрузки от Imax, А;     Интервал жидания, с;     Напряжение питания от U_pit, В;
call INSTB_I_Upit_H_CH2        2               1                                   1                                             1,1                                   5k                            1                                        

###################################################################################################################################################################
#/     Определение нестабильности выходного тока при изменении выходного напряжения.               #uhesh(INSTB_I_Unagr_H_CH2)
###################################################################################################################################################################

#                                   Диапазон;          Ток СИ от Imax, А;          Напряжение СИ от U_max, В;          Ток нагрузки от Imax, А;     Интервал жидания, с;     Выходное напряжение от U_max 2, В;
call INSTB_I_Unagr_H_CH2       2               1                                             1                                             1,1                                   5k                            0,5                                       

####################################
#/ Диапазон выходных величин "Low"     Канал 2
####################################

##################################################################################################################################################################
#/     Определение абсолютной погрешности формирования выходного постоянного напряжения.                #uhesh(VDC_L_CH2)
##################################################################################################################################################################

#                                   Диапазон;      Напряжение СИ от U_max, В;          Ток СИ от Imax, А;          Ток нагрузки от Imax, А;     Интервал жидания, с;     
call VDC_L_CH2                    2               1                                             1                            0,8                         5k
call VDC_L_CH2                    2               0,8                                             1                         0,8                              5k
call VDC_L_CH2                    2               0,6                                             1                         0,8                              5k
call VDC_L_CH2                    2               0,4                                             1                         0,8                              5k
call VDC_L_CH2                    2               0,2                                             1                         0,8                              5k

##################################################################################################################################################################
#/     Определение абсолютной погрешности измерения выходного постоянного напряжения.                #uhesh(VDC_izm_L_CH2)
##################################################################################################################################################################

#                                   Диапазон;      Напряжение СИ от U_max, В;          Ток СИ от Imax, А;          Ток нагрузки от Imax, А;     Интервал жидания, с;     
call VDC_izm_L_CH2               2        0,2        1                                                                          0                              5k
call VDC_izm_L_CH2               2        0,4        1                                                                          0                              5k
call VDC_izm_L_CH2               2        0,6        1                                                                          0                              5k
call VDC_izm_L_CH2               2        0,8        1                                                                          0                              5k
call VDC_izm_L_CH2               2        1          1                                                                           0                         5k

###################################################################################################################################################################
#/     Определение нестабильности выходного напряжения при изменении напряжения питающей сети.     #uhesh(INSTB_U_Upit_L_CH2)      
###################################################################################################################################################################

#                                   Диапазон;     Напряжение СИ от U_max, В;          Ток СИ от Imax, А;          Ток нагрузки от Imax, А;     Интервал жидания, с;     Напряжение питания от U_pit, В;     
call INSTB_U_Upit_L_CH2        2          1                                             1                                   0,8                                   5k                              1                                             

###################################################################################################################################################################
#/     Определение нестабильности выходного напряжения при изменении тока нагрузки.                     #uhesh(INSTB_U_Inagr_L_CH2)     
###################################################################################################################################################################

#                                   Диапазон;     Напряжение СИ от U_max, В;          Ток СИ от Imax, А;          Ток нагрузки от Imax, А;     Интервал жидания, с;     Выходной ток от I_max 2, В;
call INSTB_U_Inagr_L_CH2       			   2         				 1                         			          1                                  0,8                                  5k                                   0                                

###################################################################################################################################################################
#/     Определение абсолютной погрешности формирования силы выходного тока.                               #uhesh(IDC_L_CH2)     
###################################################################################################################################################################

#                                   Диапазон;     Ток СИ от Imax, А;          Напряжение СИ от U_max, В;          Ток нагрузки от Imax, А;     Интервал жидания, с;     
call IDC_L_CH2                    2               0,2                                   1                                        1,1                         5k
call IDC_L_CH2                    2               0,4                                   1                                        1,1                         5k
call IDC_L_CH2                    2               0,6                                   1                                        1,1                         5k
call IDC_L_CH2                    2               0,8                                   1                                        1,1                         5k
call IDC_L_CH2                    2               1                                   1                                             1,1                         5k

###################################################################################################################################################################
#/     Определение абсолютной погрешности измерения силы выходного тока.                                    #uhesh(IDC_izm_L_CH2)     
###################################################################################################################################################################

#                                   Диапазон;     Ток СИ от Imax, А;          Напряжение СИ от U_max, В;          Ток нагрузки от Imax, А;     Интервал жидания, с;     
call IDC_izm_L_CH2               2                1        1                                                                            1,1                                   5k
call IDC_izm_L_CH2               2                0,8      1                                                                         1,1                                   5k
call IDC_izm_L_CH2               2                0,6      1                                                                         1,1                                   5k
call IDC_izm_L_CH2               2                0,4      1                                                                         1,1                                   5k
call IDC_izm_L_CH2               2                0,2      1                                                                         1,1                                   5k

###################################################################################################################################################################
#/ Определение нестабильности выходного тока при изменении напряжения питающей сети.               #uhesh(INSTB_I_Upit_L_CH2)                    
###################################################################################################################################################################

#                                   Диапазон;          Ток СИ от Imax, А;          Напряжение СИ от U_max, В;           Ток нагрузки от Imax, А;     Интервал жидания, с;     Напряжение питания от U_pit, В;
call INSTB_I_Upit_L_CH2         2               1                                   0,5                                             1,1                                   5k                            1                                        

###################################################################################################################################################################
#/     Определение нестабильности выходного тока при изменении выходного напряжения.                    #uhesh(INSTB_I_Unagr_L_CH2)     
###################################################################################################################################################################

#                         Диапазон;     Ток СИ от Imax, А;          Напряжение СИ от U_max, В;          Ток нагрузки от Imax, А;     Интервал жидания, с;     Выходное напряжение от U_max 2, В;
call INSTB_I_Unagr_L_CH2        2              1                                   1                                             1,1                                   5k                            0,5                                  

#########################################################################################################################################################################
#########   E   N   D   ###############################################################################################################################
#########################################################################################################################################################################

# Функция сброса всех приборов в изначальное состояние
call RESET_ALL
     if TestResult
          report result "годным"
     else
          report result "не годным"
     endif

EndScript  

#########################################################################################################################################################################
########   F   U   N   C   T   I   O   N   S   ##################################################################################################################################
#########################################################################################################################################################################

Function MODE_PRIBOR_CHOICE
     Driverget  AgilentE36xx mem_1 =  MODEL                                   #      Запрос модели модуля
     CaseOne     
          when mem_1="E3640A"
               define Model_SI_Report                E3640A                         #     Модель поверяемого источника питания
               define Model_SI_Driver                AgilentE36xx                    #     Модель поверяемого источника питания
               define U_max                              20                              #     Максимальное выходное напряжени
               define I_max                              1,5                              #     Максимальный выходной ток          
               define U2_max                              8                              #     Максимальное выходное напряжени
               define I2_max                              3                              #     Максимальный выходной ток          
               define VDC_coe                              0,5m                         #     Коэффициент для расчета допускаемой погрешности, мВ
               define VDC_con                              10m                              #     Константа для расчета допускаемой погрешности, мВ
               define VDC2_coe                         0,5m                         #     Коэффициент для расчета допускаемой погрешности, мВ
               define VDC2_con                         10m                              #     Константа для расчета допускаемой погрешности, мВ
               define VDCpit_coe                         0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Upit, мВ
               define VDCpit_con                         3m                              #     Константа для расчета допускаемой нестабильности напряжения от Upit, мВ     
               define VDCnagr_coe                    0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Inag, мВ
               define VDCnagr_con                    3m                              #     Константа для расчета допускаемой нестабильности напряжения от Inag, мВ     
               define VDCpuls_coe                    0                              #     Коэффициент для расчета допускаемого уровня пульсаций, мВ
               define VDCpuls_con                    0                              #     Константа для расчета допускаемого уровня пульсаций, мВ                                             
               define IDC_coe                              2m                              #     Коэффициент для расчета допускаемой погрешности, мА     
               define IDC_con                              10m                              #     Константа для расчета допускаемой погрешности, мА
               define IDCpit_coe                         0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Upit, мА
               define IDCpit_con                         0,25m                         #     Константа для расчета допускаемой нестабильности напряжения от Upit, мА          
               define IDCnagr_coe                    0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Unag, мА
               define IDCnagr_con                    0,25m                         #     Константа для расчета допускаемой нестабильности напряжения от Unag, мА               
               define IDCpuls_coe                    0                              #     Коэффициент для расчета допускаемого уровня пульсаций, мА
               define IDCpuls_con                    0                              #     Константа для расчета допускаемого уровня пульсаций, мВ
               define Interface                         true                         #     Наоличие интерфейса: 0 - нет, 1 - есть
               define CHANEL_NOM                         1                              #     Количество каналов
               define     MeasureVDC                         true                         #     Наличие поверки режима измерения напряжения
               define     MeasureIDC                         true                         #     Наличие поверки режима измерения тока
               define     VDCch1_izm_coe                    0,5m                         #     Коэффициент для расчета погрешности измерения напряжения
               define     VDCch1_izm_con                    5m                              #     Константа для расчета погрешности измерения напряжения
               define     VDCch2_izm_coe                    0                              #     Коэффициент для расчета погрешности измерения напряжения
               define     VDCch2_izm_con                    0                              #     Константа для расчета погрешности измерения напряжения
               define     IDCch1_izm_coe                    1,5m                         #     Коэффициент для расчета погрешности измерения тока
               define     IDCch1_izm_con                    5m                              #     Константа для расчета погрешности измерения тока     
               define     IDCch2_izm_coe                    0                              #     Коэффициент для расчета погрешности измерения тока
               define     IDCch2_izm_con                    0                              #     Константа для расчета погрешности измерения тока     
          when mem_1="E3641A"
               define Model_SI_Report                E3641A                    #     Модель поверяемого источника питания
               define Model_SI_Driver                AgilentE36xx                         #     Модель поверяемого источника питания
               define U_max                              60                              #     Максимальное выходное напряжени
               define I_max                              0,5                              #     Максимальный выходной ток          
               define U2_max                              35                              #     Максимальное выходное напряжени
               define I2_max                              0,8                              #     Максимальный выходной ток          
               define VDC_coe                              0,5m                         #     Коэффициент для расчета допускаемой погрешности, мВ
               define VDC_con                              10m                              #     Константа для расчета допускаемой погрешности, мВ
               define VDC2_coe                         0,5m                         #     Коэффициент для расчета допускаемой погрешности, мВ
               define VDC2_con                         10m                              #     Константа для расчета допускаемой погрешности, мВ
               define VDCpit_coe                         0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Upit, мВ
               define VDCpit_con                         3m                              #     Константа для расчета допускаемой нестабильности напряжения от Upit, мВ     
               define VDCnagr_coe                    0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Inag, мВ
               define VDCnagr_con                    3m                              #     Константа для расчета допускаемой нестабильности напряжения от Inag, мВ     
               define VDCpuls_coe                    0                              #     Коэффициент для расчета допускаемого уровня пульсаций, мВ
               define VDCpuls_con                    0                              #     Константа для расчета допускаемого уровня пульсаций, мВ                                             
               define IDC_coe                              2m                              #     Коэффициент для расчета допускаемой погрешности, мА     
               define IDC_con                              10m                              #     Константа для расчета допускаемой погрешности, мА
               define IDCpit_coe                         0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Upit, мА
               define IDCpit_con                         0,25m                         #     Константа для расчета допускаемой нестабильности напряжения от Upit, мА          
               define IDCnagr_coe                    0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Unag, мА
               define IDCnagr_con                    0,25m                         #     Константа для расчета допускаемой нестабильности напряжения от Unag, мА               
               define IDCpuls_coe                    0                              #     Коэффициент для расчета допускаемого уровня пульсаций, мА
               define IDCpuls_con                    0                              #     Константа для расчета допускаемого уровня пульсаций, мВ
               define Interface                         true                         #     Наоличие интерфейса: 0 - нет, 1 - есть
               define CHANEL_NOM                         1                              #     Количество каналов
               define     MeasureVDC                         true                         #     Наличие поверки режима измерения напряжения
               define     MeasureIDC                         true                         #     Наличие поверки режима измерения тока
               define     VDCch1_izm_coe                    0,5m                         #     Коэффициент для расчета погрешности измерения напряжения
               define     VDCch1_izm_con                    5m                              #     Константа для расчета погрешности измерения напряжения
               define     VDCch2_izm_coe                    0                              #     Коэффициент для расчета погрешности измерения напряжения
               define     VDCch2_izm_con                    0                              #     Константа для расчета погрешности измерения напряжения
               define     IDCch1_izm_coe                    1,5m                         #     Коэффициент для расчета погрешности измерения тока
               define     IDCch1_izm_con                    5m                              #     Константа для расчета погрешности измерения тока     
               define     IDCch2_izm_coe                    0                              #     Коэффициент для расчета погрешности измерения тока
               define     IDCch2_izm_con                    0                              #     Константа для расчета погрешности измерения тока     
          when mem_1="E3642A"
               define Model_SI_Report                E3642A                         #     Модель поверяемого источника питания
               define Model_SI_Driver                AgilentE36xx                         #     Модель поверяемого источника питания
               define U_max                              20                              #     Максимальное выходное напряжени
               define I_max                              2,5                              #     Максимальный выходной ток          
               define U2_max                              8                              #     Максимальное выходное напряжени
               define I2_max                              5                              #     Максимальный выходной ток          
               define VDC_coe                              0,5m                         #     Коэффициент для расчета допускаемой погрешности, мВ
               define VDC_con                              10m                              #     Константа для расчета допускаемой погрешности, мВ
               define VDC2_coe                         0,5m                         #     Коэффициент для расчета допускаемой погрешности, мВ
               define VDC2_con                         10m                              #     Константа для расчета допускаемой погрешности, мВ
               define VDCpit_coe                         0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Upit, мВ
               define VDCpit_con                         3m                              #     Константа для расчета допускаемой нестабильности напряжения от Upit, мВ     
               define VDCnagr_coe                    0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Inag, мВ
               define VDCnagr_con                    3m                              #     Константа для расчета допускаемой нестабильности напряжения от Inag, мВ     
               define VDCpuls_coe                    0                              #     Коэффициент для расчета допускаемого уровня пульсаций, мВ
               define VDCpuls_con                    0                              #     Константа для расчета допускаемого уровня пульсаций, мВ                                             
               define IDC_coe                              2m                              #     Коэффициент для расчета допускаемой погрешности, мА     
               define IDC_con                              10m                              #     Константа для расчета допускаемой погрешности, мА
               define IDCpit_coe                         0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Upit, мА
               define IDCpit_con                         0,25m                         #     Константа для расчета допускаемой нестабильности напряжения от Upit, мА          
               define IDCnagr_coe                    0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Unag, мА
               define IDCnagr_con                    0,25m                         #     Константа для расчета допускаемой нестабильности напряжения от Unag, мА               
               define IDCpuls_coe                    0                              #     Коэффициент для расчета допускаемого уровня пульсаций, мА
               define IDCpuls_con                    0                              #     Константа для расчета допускаемого уровня пульсаций, мВ
               define Interface                         true                         #     Наоличие интерфейса: 0 - нет, 1 - есть
               define CHANEL_NOM                         1                              #     Количество каналов
               define     MeasureVDC                         true                         #     Наличие поверки режима измерения напряжения
               define     MeasureIDC                         true                         #     Наличие поверки режима измерения тока
               define     VDCch1_izm_coe                    0,5m                         #     Коэффициент для расчета погрешности измерения напряжения
               define     VDCch1_izm_con                    5m                              #     Константа для расчета погрешности измерения напряжения
               define     VDCch2_izm_coe                    0                              #     Коэффициент для расчета погрешности измерения напряжения
               define     VDCch2_izm_con                    0                              #     Константа для расчета погрешности измерения напряжения
               define     IDCch1_izm_coe                    1,5m                         #     Коэффициент для расчета погрешности измерения тока
               define     IDCch1_izm_con                    5m                              #     Константа для расчета погрешности измерения тока     
               define     IDCch2_izm_coe                    0                              #     Коэффициент для расчета погрешности измерения тока
               define     IDCch2_izm_con                    0                              #     Константа для расчета погрешности измерения тока     
          when mem_1="E3643A"
               define Model_SI_Report                E3643A                         #     Модель поверяемого источника питания
               define Model_SI_Driver                AgilentE36xx                         #     Модель поверяемого источника питания
               define U_max                              60                              #     Максимальное выходное напряжени
               define I_max                              0,8                              #     Максимальный выходной ток          
               define U2_max                              35                              #     Максимальное выходное напряжени
               define I2_max                              1,4                              #     Максимальный выходной ток          
               define VDC_coe                              0,5m                         #     Коэффициент для расчета допускаемой погрешности, мВ
               define VDC_con                              10m                              #     Константа для расчета допускаемой погрешности, мВ
               define VDC2_coe                         0,5m                         #     Коэффициент для расчета допускаемой погрешности, мВ
               define VDC2_con                         10m                              #     Константа для расчета допускаемой погрешности, мВ
               define VDCpit_coe                         0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Upit, мВ
               define VDCpit_con                         3m                              #     Константа для расчета допускаемой нестабильности напряжения от Upit, мВ     
               define VDCnagr_coe                    0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Inag, мВ
               define VDCnagr_con                    3m                              #     Константа для расчета допускаемой нестабильности напряжения от Inag, мВ     
               define VDCpuls_coe                    0                              #     Коэффициент для расчета допускаемого уровня пульсаций, мВ
               define VDCpuls_con                    0                              #     Константа для расчета допускаемого уровня пульсаций, мВ                                             
               define IDC_coe                              2m                              #     Коэффициент для расчета допускаемой погрешности, мА     
               define IDC_con                              10m                              #     Константа для расчета допускаемой погрешности, мА
               define IDCpit_coe                         0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Upit, мА
               define IDCpit_con                         0,25m                         #     Константа для расчета допускаемой нестабильности напряжения от Upit, мА          
               define IDCnagr_coe                    0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Unag, мА
               define IDCnagr_con                    0,25m                         #     Константа для расчета допускаемой нестабильности напряжения от Unag, мА               
               define IDCpuls_coe                    0                              #     Коэффициент для расчета допускаемого уровня пульсаций, мА
               define IDCpuls_con                    0                              #     Константа для расчета допускаемого уровня пульсаций, мВ
               define Interface                         true                         #     Наоличие интерфейса: 0 - нет, 1 - есть
               define CHANEL_NOM                         1                              #     Количество каналов
               define     MeasureVDC                         true                         #     Наличие поверки режима измерения напряжения
               define     MeasureIDC                         true                         #     Наличие поверки режима измерения тока
               define     VDCch1_izm_coe                    0,5m                         #     Коэффициент для расчета погрешности измерения напряжения
               define     VDCch1_izm_con                    5m                              #     Константа для расчета погрешности измерения напряжения
               define     VDCch2_izm_coe                    0                              #     Коэффициент для расчета погрешности измерения напряжения
               define     VDCch2_izm_con                    0                              #     Константа для расчета погрешности измерения напряжения
               define     IDCch1_izm_coe                    1,5m                         #     Коэффициент для расчета погрешности измерения тока
               define     IDCch1_izm_con                    5m                              #     Константа для расчета погрешности измерения тока     
               define     IDCch2_izm_coe                    0                              #     Коэффициент для расчета погрешности измерения тока
               define     IDCch2_izm_con                    0                              #     Константа для расчета погрешности измерения тока     
          when mem_1="E3644A"
               define Model_SI_Report                E3644A                         #     Модель поверяемого источника питания
               define Model_SI_Driver                AgilentE36xx                    #     Модель поверяемого источника питания
               define U_max                              20                              #     Максимальное выходное напряжени
               define I_max                              4                              #     Максимальный выходной ток          
               define U2_max                              8                              #     Максимальное выходное напряжени
               define I2_max                              8                              #     Максимальный выходной ток          
               define VDC_coe                              0,5m                         #     Коэффициент для расчета допускаемой погрешности, мВ
               define VDC_con                              10m                              #     Константа для расчета допускаемой погрешности, мВ
               define VDC2_coe                         0,5m                         #     Коэффициент для расчета допускаемой погрешности, мВ
               define VDC2_con                         10m                              #     Константа для расчета допускаемой погрешности, мВ
               define VDCpit_coe                         0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Upit, мВ
               define VDCpit_con                         3m                              #     Константа для расчета допускаемой нестабильности напряжения от Upit, мВ     
               define VDCnagr_coe                    0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Inag, мВ
               define VDCnagr_con                    3m                              #     Константа для расчета допускаемой нестабильности напряжения от Inag, мВ     
               define VDCpuls_coe                    0                              #     Коэффициент для расчета допускаемого уровня пульсаций, мВ
               define VDCpuls_con                    0                              #     Константа для расчета допускаемого уровня пульсаций, мВ                                             
               define IDC_coe                              2m                              #     Коэффициент для расчета допускаемой погрешности, мА     
               define IDC_con                              10m                              #     Константа для расчета допускаемой погрешности, мА
               define IDCpit_coe                         0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Upit, мА
               define IDCpit_con                         0,25m                         #     Константа для расчета допускаемой нестабильности напряжения от Upit, мА          
               define IDCnagr_coe                    0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Unag, мА
               define IDCnagr_con                    0,25m                         #     Константа для расчета допускаемой нестабильности напряжения от Unag, мА               
               define IDCpuls_coe                    0                              #     Коэффициент для расчета допускаемого уровня пульсаций, мА
               define IDCpuls_con                    0                              #     Константа для расчета допускаемого уровня пульсаций, мВ
               define Interface                         true                         #     Наоличие интерфейса: 0 - нет, 1 - есть
               define CHANEL_NOM                         1                              #     Количество каналов
               define     MeasureVDC                         true                         #     Наличие поверки режима измерения напряжения
               define     MeasureIDC                         true                         #     Наличие поверки режима измерения тока
               define     VDCch1_izm_coe                    0,5m                         #     Коэффициент для расчета погрешности измерения напряжения
               define     VDCch1_izm_con                    5m                              #     Константа для расчета погрешности измерения напряжения
               define     VDCch2_izm_coe                    0                              #     Коэффициент для расчета погрешности измерения напряжения
               define     VDCch2_izm_con                    0                              #     Константа для расчета погрешности измерения напряжения
               define     IDCch1_izm_coe                    1,5m                         #     Коэффициент для расчета погрешности измерения тока
               define     IDCch1_izm_con                    5m                              #     Константа для расчета погрешности измерения тока     
               define     IDCch2_izm_coe                    0                              #     Коэффициент для расчета погрешности измерения тока
               define     IDCch2_izm_con                    0                              #     Константа для расчета погрешности измерения тока     
          when mem_1="E3645A"
               define Model_SI_Report                E3645A                         #     Модель поверяемого источника питания
               define Model_SI_Driver                AgilentE36xx                    #     Модель поверяемого источника питания
               define U_max                              60                              #     Максимальное выходное напряжени
               define I_max                              1,3                              #     Максимальный выходной ток          
               define U2_max                              35                              #     Максимальное выходное напряжени
               define I2_max                              2,2                              #     Максимальный выходной ток          
               define VDC_coe                              0,5m                         #     Коэффициент для расчета допускаемой погрешности, мВ
               define VDC_con                              10m                              #     Константа для расчета допускаемой погрешности, мВ
               define VDC2_coe                         0,5m                         #     Коэффициент для расчета допускаемой погрешности, мВ
               define VDC2_con                         10m                              #     Константа для расчета допускаемой погрешности, мВ
               define VDCpit_coe                         0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Upit, мВ
               define VDCpit_con                         3m                              #     Константа для расчета допускаемой нестабильности напряжения от Upit, мВ     
               define VDCnagr_coe                    0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Inag, мВ
               define VDCnagr_con                    3m                              #     Константа для расчета допускаемой нестабильности напряжения от Inag, мВ     
               define VDCpuls_coe                    0                              #     Коэффициент для расчета допускаемого уровня пульсаций, мВ
               define VDCpuls_con                    0                              #     Константа для расчета допускаемого уровня пульсаций, мВ                                             
               define IDC_coe                              2m                              #     Коэффициент для расчета допускаемой погрешности, мА     
               define IDC_con                              10m                              #     Константа для расчета допускаемой погрешности, мА
               define IDCpit_coe                         0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Upit, мА
               define IDCpit_con                         0,25m                         #     Константа для расчета допускаемой нестабильности напряжения от Upit, мА          
               define IDCnagr_coe                    0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Unag, мА
               define IDCnagr_con                    0,25m                         #     Константа для расчета допускаемой нестабильности напряжения от Unag, мА               
               define IDCpuls_coe                    0                              #     Коэффициент для расчета допускаемого уровня пульсаций, мА
               define IDCpuls_con                    0                              #     Константа для расчета допускаемого уровня пульсаций, мВ
               define Interface                         true                         #     Наоличие интерфейса: 0 - нет, 1 - есть
               define CHANEL_NOM                         1                              #     Количество каналов
               define     MeasureVDC                         true                         #     Наличие поверки режима измерения напряжения
               define     MeasureIDC                         true                         #     Наличие поверки режима измерения тока
               define     VDCch1_izm_coe                    0,5m                         #     Коэффициент для расчета погрешности измерения напряжения
               define     VDCch1_izm_con                    5m                              #     Константа для расчета погрешности измерения напряжения
               define     VDCch2_izm_coe                    0                              #     Коэффициент для расчета погрешности измерения напряжения
               define     VDCch2_izm_con                    0                              #     Константа для расчета погрешности измерения напряжения
               define     IDCch1_izm_coe                    1,5m                         #     Коэффициент для расчета погрешности измерения тока
               define     IDCch1_izm_con                    5m                              #     Константа для расчета погрешности измерения тока     
               define     IDCch2_izm_coe                    0                              #     Коэффициент для расчета погрешности измерения тока
               define     IDCch2_izm_con                    0                              #     Константа для расчета погрешности измерения тока     
          when mem_1="E3646A"
               define Model_SI_Report                E3646A                              #     Модель поверяемого источника питания
               define Model_SI_Driver                AgilentE36xx                    #     Модель поверяемого источника питания
               define U_max                              20                              #     Максимальное выходное напряжени
               define I_max                              1,5                              #     Максимальный выходной ток          
               define U2_max                              8                              #     Максимальное выходное напряжени
               define I2_max                              3                              #     Максимальный выходной ток          
               define VDC_coe                              0,5m                         #     Коэффициент для расчета допускаемой погрешности, мВ
               define VDC_con                              10m                              #     Константа для расчета допускаемой погрешности, мВ
               define VDC2_coe                         1m                              #     Коэффициент для расчета допускаемой погрешности, мВ
               define VDC2_con                         25m                              #     Константа для расчета допускаемой погрешности, мВ
               define VDCpit_coe                         0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Upit, мВ
               define VDCpit_con                         3m                              #     Константа для расчета допускаемой нестабильности напряжения от Upit, мВ     
               define VDCnagr_coe                    0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Inag, мВ
               define VDCnagr_con                    3m                              #     Константа для расчета допускаемой нестабильности напряжения от Inag, мВ     
               define VDCpuls_coe                    0                              #     Коэффициент для расчета допускаемого уровня пульсаций, мВ
               define VDCpuls_con                    0                              #     Константа для расчета допускаемого уровня пульсаций, мВ                                             
               define IDC_coe                              2m                              #     Коэффициент для расчета допускаемой погрешности, мА     
               define IDC_con                              10m                              #     Константа для расчета допускаемой погрешности, мА
               define IDCpit_coe                         0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Upit, мА
               define IDCpit_con                         0,25m                         #     Константа для расчета допускаемой нестабильности напряжения от Upit, мА          
               define IDCnagr_coe                    0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Unag, мА
               define IDCnagr_con                    0,25m                         #     Константа для расчета допускаемой нестабильности напряжения от Unag, мА               
               define IDCpuls_coe                    0                              #     Коэффициент для расчета допускаемого уровня пульсаций, мА
               define IDCpuls_con                    0                              #     Константа для расчета допускаемого уровня пульсаций, мВ
               define Interface                         true                         #     Наоличие интерфейса: 0 - нет, 1 - есть
               define CHANEL_NOM                         2                              #     Количество каналов
               define     MeasureVDC                         true                         #     Наличие поверки режима измерения напряжения
               define     MeasureIDC                         true                         #     Наличие поверки режима измерения тока
               define     VDCch1_izm_coe                    0,5m                         #     Коэффициент для расчета погрешности измерения напряжения
               define     VDCch1_izm_con                    5m                              #     Константа для расчета погрешности измерения напряжения
               define     VDCch2_izm_coe                    1m                              #     Коэффициент для расчета погрешности измерения напряжения
               define     VDCch2_izm_con                    25m                              #     Константа для расчета погрешности измерения напряжения
               define     IDCch1_izm_coe                    1,5m                         #     Коэффициент для расчета погрешности измерения тока
               define     IDCch1_izm_con                    5m                              #     Константа для расчета погрешности измерения тока     
               define     IDCch2_izm_coe                    1,5m                         #     Коэффициент для расчета погрешности измерения тока
               define     IDCch2_izm_con                    10m                              #     Константа для расчета погрешности измерения тока     
          when mem_1="E3647A"
               define Model_SI_Report                E3647A                         #     Модель поверяемого источника питания
               define Model_SI_Driver                AgilentE36xx                         #     Модель поверяемого источника питания
               define U_max                              60                              #     Максимальное выходное напряжени
               define I_max                              0,5                              #     Максимальный выходной ток          
               define U2_max                              35                              #     Максимальное выходное напряжени
               define I2_max                              0,8                              #     Максимальный выходной ток          
               define VDC_coe                              0,5m                         #     Коэффициент для расчета допускаемой погрешности, мВ
               define VDC_con                              10m                              #     Константа для расчета допускаемой погрешности, мВ
               define VDC2_coe                         1m                              #     Коэффициент для расчета допускаемой погрешности, мВ
               define VDC2_con                         25m                              #     Константа для расчета допускаемой погрешности, мВ
               define VDCpit_coe                         0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Upit, мВ
               define VDCpit_con                         3m                              #     Константа для расчета допускаемой нестабильности напряжения от Upit, мВ     
               define VDCnagr_coe                    0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Inag, мВ
               define VDCnagr_con                    3m                              #     Константа для расчета допускаемой нестабильности напряжения от Inag, мВ     
               define VDCpuls_coe                    0                              #     Коэффициент для расчета допускаемого уровня пульсаций, мВ
               define VDCpuls_con                    0                              #     Константа для расчета допускаемого уровня пульсаций, мВ                                             
               define IDC_coe                              2m                              #     Коэффициент для расчета допускаемой погрешности, мА     
               define IDC_con                              10m                              #     Константа для расчета допускаемой погрешности, мА
               define IDCpit_coe                         0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Upit, мА
               define IDCpit_con                         0,25m                         #     Константа для расчета допускаемой нестабильности напряжения от Upit, мА          
               define IDCnagr_coe                    0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Unag, мА
               define IDCnagr_con                    0,25m                         #     Константа для расчета допускаемой нестабильности напряжения от Unag, мА               
               define IDCpuls_coe                    0                              #     Коэффициент для расчета допускаемого уровня пульсаций, мА
               define IDCpuls_con                    0                              #     Константа для расчета допускаемого уровня пульсаций, мВ
               define Interface                         true                         #     Наоличие интерфейса: 0 - нет, 1 - есть
               define CHANEL_NOM                         2                              #     Количество каналов
               define     MeasureVDC                         true                         #     Наличие поверки режима измерения напряжения
               define     MeasureIDC                         true                         #     Наличие поверки режима измерения тока
               define     VDCch1_izm_coe                    0,5m                         #     Коэффициент для расчета погрешности измерения напряжения
               define     VDCch1_izm_con                    5m                              #     Константа для расчета погрешности измерения напряжения
               define     VDCch2_izm_coe                    1m                              #     Коэффициент для расчета погрешности измерения напряжения
               define     VDCch2_izm_con                    25m                              #     Константа для расчета погрешности измерения напряжения
               define     IDCch1_izm_coe                    1,5m                         #     Коэффициент для расчета погрешности измерения тока
               define     IDCch1_izm_con                    5m                              #     Константа для расчета погрешности измерения тока     
               define     IDCch2_izm_coe                    1,5m                         #     Коэффициент для расчета погрешности измерения тока
               define     IDCch2_izm_con                    10m                              #     Константа для расчета погрешности измерения тока     
          when mem_1="E3648A"
               define Model_SI_Report                E3648A                              #     Модель поверяемого источника питания
               define Model_SI_Driver                AgilentE36xx                    #     Модель поверяемого источника питания
               define U_max                              20                              #     Максимальное выходное напряжени
               define I_max                              2,5                              #     Максимальный выходной ток          
               define U2_max                              8                              #     Максимальное выходное напряжени
               define I2_max                              5                              #     Максимальный выходной ток          
               define VDC_coe                              0,5m                         #     Коэффициент для расчета допускаемой погрешности, мВ
               define VDC_con                              10m                              #     Константа для расчета допускаемой погрешности, мВ
               define VDC2_coe                         1m                              #     Коэффициент для расчета допускаемой погрешности, мВ
               define VDC2_con                         25m                              #     Константа для расчета допускаемой погрешности, мВ
               define VDCpit_coe                         0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Upit, мВ
               define VDCpit_con                         3m                              #     Константа для расчета допускаемой нестабильности напряжения от Upit, мВ     
               define VDCnagr_coe                    0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Inag, мВ
               define VDCnagr_con                    3m                              #     Константа для расчета допускаемой нестабильности напряжения от Inag, мВ     
               define VDCpuls_coe                    0                              #     Коэффициент для расчета допускаемого уровня пульсаций, мВ
               define VDCpuls_con                    0                              #     Константа для расчета допускаемого уровня пульсаций, мВ                                             
               define IDC_coe                              2m                              #     Коэффициент для расчета допускаемой погрешности, мА     
               define IDC_con                              10m                              #     Константа для расчета допускаемой погрешности, мА
               define IDCpit_coe                         0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Upit, мА
               define IDCpit_con                         0,25m                         #     Константа для расчета допускаемой нестабильности напряжения от Upit, мА          
               define IDCnagr_coe                    0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Unag, мА
               define IDCnagr_con                    0,25m                         #     Константа для расчета допускаемой нестабильности напряжения от Unag, мА               
               define IDCpuls_coe                    0                              #     Коэффициент для расчета допускаемого уровня пульсаций, мА
               define IDCpuls_con                    0                              #     Константа для расчета допускаемого уровня пульсаций, мВ
               define Interface                         true                         #     Наоличие интерфейса: 0 - нет, 1 - есть
               define CHANEL_NOM                         2                              #     Количество каналов
               define     MeasureVDC                         true                         #     Наличие поверки режима измерения напряжения
               define     MeasureIDC                         true                         #     Наличие поверки режима измерения тока
               define     VDCch1_izm_coe                    0,5m                         #     Коэффициент для расчета погрешности измерения напряжения
               define     VDCch1_izm_con                    5m                              #     Константа для расчета погрешности измерения напряжения
               define     VDCch2_izm_coe                    1m                              #     Коэффициент для расчета погрешности измерения напряжения
               define     VDCch2_izm_con                    25m                              #     Константа для расчета погрешности измерения напряжения
               define     IDCch1_izm_coe                    1,5m                         #     Коэффициент для расчета погрешности измерения тока
               define     IDCch1_izm_con                    5m                              #     Константа для расчета погрешности измерения тока     
               define     IDCch2_izm_coe                    1,5m                         #     Коэффициент для расчета погрешности измерения тока
               define     IDCch2_izm_con                    10m                              #     Константа для расчета погрешности измерения тока     
          when mem_1="E3649A"
               define Model_SI_Report                E3649A                         #     Модель поверяемого источника питания
               define Model_SI_Driver                AgilentE36xx                         #     Модель поверяемого источника питания
               define U_max                              60                              #     Максимальное выходное напряжени
               define I_max                              0,8                              #     Максимальный выходной ток          
               define U2_max                              35                              #     Максимальное выходное напряжени
               define I2_max                              1,4                              #     Максимальный выходной ток          
               define VDC_coe                              0,5m                         #     Коэффициент для расчета допускаемой погрешности, мВ
               define VDC_con                              10m                              #     Константа для расчета допускаемой погрешности, мВ
               define VDC2_coe                         1m                              #     Коэффициент для расчета допускаемой погрешности, мВ
               define VDC2_con                         25m                              #     Константа для расчета допускаемой погрешности, мВ
               define VDCpit_coe                         0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Upit, мВ
               define VDCpit_con                         3m                              #     Константа для расчета допускаемой нестабильности напряжения от Upit, мВ     
               define VDCnagr_coe                    0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Inag, мВ
               define VDCnagr_con                    3m                              #     Константа для расчета допускаемой нестабильности напряжения от Inag, мВ     
               define VDCpuls_coe                    0                              #     Коэффициент для расчета допускаемого уровня пульсаций, мВ
               define VDCpuls_con                    0                              #     Константа для расчета допускаемого уровня пульсаций, мВ                                             
               define IDC_coe                              2m                              #     Коэффициент для расчета допускаемой погрешности, мА     
               define IDC_con                              10m                              #     Константа для расчета допускаемой погрешности, мА
               define IDCpit_coe                         0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Upit, мА
               define IDCpit_con                         0,25m                         #     Константа для расчета допускаемой нестабильности напряжения от Upit, мА          
               define IDCnagr_coe                    0,1m                         #     Коэффициент для расчета допускаемой нестабильности напряжения от Unag, мА
               define IDCnagr_con                    0,25m                         #     Константа для расчета допускаемой нестабильности напряжения от Unag, мА               
               define IDCpuls_coe                    0                              #     Коэффициент для расчета допускаемого уровня пульсаций, мА
               define IDCpuls_con                    0                              #     Константа для расчета допускаемого уровня пульсаций, мВ
               define Interface                         true                         #     Наоличие интерфейса: 0 - нет, 1 - есть
               define CHANEL_NOM                         2                              #     Количество каналов
               define     MeasureVDC                         true                         #     Наличие поверки режима измерения напряжения
               define     MeasureIDC                         true                         #     Наличие поверки режима измерения тока
               define     VDCch1_izm_coe                    0,5m                         #     Коэффициент для расчета погрешности измерения напряжения
               define     VDCch1_izm_con                    5m                              #     Константа для расчета погрешности измерения напряжения
               define     VDCch2_izm_coe                    1m                              #     Коэффициент для расчета погрешности измерения напряжения
               define     VDCch2_izm_con                    25m                              #     Константа для расчета погрешности измерения напряжения
               define     IDCch1_izm_coe                    1,5m                         #     Коэффициент для расчета погрешности измерения тока
               define     IDCch1_izm_con                    5m                              #     Константа для расчета погрешности измерения тока     
               define     IDCch2_izm_coe                    1,5m                         #     Коэффициент для расчета погрешности измерения тока
               define     IDCch2_izm_con                    10m                              #     Константа для расчета погрешности измерения тока     
          EndCase
     DriverSet  Model_SI_Driver   RESET                                             #  "PRESET", "Reset", "RST"                     
     Driverget  Model_SI_Driver mem_1 =  MODEL                                   #      Запрос модели модуля
     Driverget  Model_SI_Driver mem_4 =  SERIAL                                   #      Запрос номера модуля
     DriverSet  Model_SI_Driver OUT = 1
     
     define METODIKA_POVERKI                          E3645A-MY4000 МП                                   #     Методика поверки
     define METODIKA_OSMOTR                          7.1                                                       #     № пункта для "Внешнего осмотра"
     define METODIKA_OPROB                          7.2                                                       #     № пункта для "Опробования"
     define U_pit                                        220                                                       #     Номинальное напряжение питания прибора
     define RegNum                                        26951-04                                             #     Номер в Госреестре
     # Вывод данных в протокол
 	report METPOV		"METODIKA_POVERKI"
    report modul_num     "mem_4"
     report Num                                             "RegNum"
     report Imax                                        "Канал 1(2): диапазон High I_max А, диапазон Low I2_max А"
     report Umax                                        "Канал 1(2): диапазон High U_max В, диапазон Low U2_max В"
     report Si                                             "Мера напряжения и тока Model_SI_Report"
EndFunction

# Функция выбора типа поверки
function MODE_POVERKA_CHOICE
message mem_1 selectmenu defvalue=2 "Выберите тип поверки :\n 1. Первичная \n 2. Периодическая" 
     CaseOne
     when     mem_1 = 1
          IF CHANEL_NOM = 1
               Tree Disable     VDC_L_CH2; VDC_H_CH2; VDC_izm_L_CH2; VDC_izm_H_CH2; INSTB_U_Upit_L_CH2; INSTB_U_Upit_H_CH2; INSTB_U_Inagr_L_CH2; INSTB_U_Inagr_H_CH2
               Tree Disable     IDC_L_CH2; IDC_H_CH2; IDC_izm_L_CH2; IDC_izm_H_CH2; INSTB_I_Upit_L_CH2; INSTB_I_Upit_H_CH2; INSTB_I_Unagr_L_CH2; INSTB_I_Unagr_H_CH2
               Tree Enable     INSTB_U_Upit_H; INSTB_I_Upit_H; INSTB_U_Upit_L; INSTB_I_Upit_L
          ELSE
               Tree Enable     VDC_L_CH2; VDC_H_CH2; VDC_izm_L_CH2; VDC_izm_H_CH2; INSTB_U_Upit_L_CH2; INSTB_U_Upit_H_CH2; INSTB_U_Inagr_L_CH2; INSTB_U_Inagr_H_CH2
               Tree Enable     IDC_L_CH2; IDC_H_CH2; IDC_izm_L_CH2; IDC_izm_H_CH2; INSTB_I_Upit_L_CH2; INSTB_I_Upit_H_CH2; INSTB_I_Unagr_L_CH2; INSTB_I_Unagr_H_CH2
               Tree Enable     INSTB_U_Upit_H; INSTB_I_Upit_H; INSTB_U_Upit_L; INSTB_I_Upit_L
          ENDIF
          report Vid_poverki     "Первичная"
     when     mem_1 = 2 
          IF CHANEL_NOM = 1
               Tree Disable     VDC_L_CH2; VDC_H_CH2; VDC_izm_L_CH2; VDC_izm_H_CH2; INSTB_U_Upit_L_CH2; INSTB_U_Upit_H_CH2; INSTB_U_Inagr_L_CH2; INSTB_U_Inagr_H_CH2
               Tree Disable     IDC_L_CH2; IDC_H_CH2; IDC_izm_L_CH2; IDC_izm_H_CH2; INSTB_I_Upit_L_CH2; INSTB_I_Upit_H_CH2; INSTB_I_Unagr_L_CH2; INSTB_I_Unagr_H_CH2
               Tree Disable     INSTB_U_Upit_H; INSTB_I_Upit_H; INSTB_U_Upit_L; INSTB_I_Upit_L
          ELSE
               Tree Enable     VDC_L_CH2; VDC_H_CH2; VDC_izm_L_CH2; VDC_izm_H_CH2; INSTB_U_Inagr_L_CH2; INSTB_U_Inagr_H_CH2
               Tree Enable     IDC_L_CH2; IDC_H_CH2; IDC_izm_L_CH2; IDC_izm_H_CH2; INSTB_I_Unagr_L_CH2; INSTB_I_Unagr_H_CH2
               Tree Disable     INSTB_U_Upit_H; INSTB_I_Upit_H; INSTB_U_Upit_L; INSTB_I_Upit_L; INSTB_U_Upit_L_CH2; INSTB_U_Upit_H_CH2; INSTB_I_Upit_L_CH2; INSTB_I_Upit_H_CH2
          ENDIF
          report Vid_poverki     "Периодическая"
     endcase
EndFunction
 
#Выбор модели нагрузки
Function LOAD_CHOISE
DriverSet	Keithley7001 OPEN_ALL 									#	разомкнуть все 
    math mem_1000 = I_max
    math mem_2000 = U_max
#	if (mem_1000<=360) and (mem_2000<=60)
#		define LOAD_MODEL						Akip1310				#	Используемая нагрузка(ки)
#		define Load_Max_Curr					360						#	Максимально допустимый ток нагрузки
#		define Load_Max_Volt					60						#	Максимально допустимое напряжение на нагрузке
#		define Load_Max_Power					1,8k					#	Максимальная рассеиваемая мощность
#			if	mem_1000 <= 30															#	Максимальный ток меньше 30
#				DriverSet	Keithley7001 CLOSE = [2;4;7]  							#	замкнуть выходы 2, 4, 7 для установки предела измерений в 30А
#			Else
#				DriverSet	Keithley7001 CLOSE = [3;4;7]  							#	замкнуть выходы 3, 4, 7 для установки предела измерений в 300А
#			Endif
#	else
#		if (mem_1000<=36) and (mem_2000<=300)
#			define LOAD_MODEL					Akip1320				#	Используемая нагрузка(ки)
#			define Load_Max_Curr				36						#	Максимально допустимый ток нагрузки
#			define Load_Max_Volt				300						#	Максимально допустимое напряжение на нагрузке
#			define Load_Max_Power				3,6k					#	Максимальная рассеиваемая мощность
#				if	mem_1000 <= 30
#					DriverSet	Keithley7001 CLOSE = [2;5;6]  							#	замкнуть выходы 2, 5, 6 для установки предела измерений в 30А
#				Else
#					DriverSet	Keithley7001 CLOSE = [3;5;6]  							#	замкнуть выходы 3, 5, 6 для установки предела измерений в 300А
#				Endif
#		else
#			message mem_1 defvalue=1 "Электронная нагрузка не обеспечивает требуемую нагрузку по току и/или напряжению. Выберите используемую нагрузку: \n 1 - АКИП-1310 \n 2 - АКИП-1320 \n 3 - Остановить работу"
			message mem_1 defvalue=1 "Выберите используемую нагрузку: \n 1 - АКИП-1310 \n 2 - АКИП-1320 \n 3 - Остановить работу"
			if mem_1 = 1
				define LOAD_MODEL				Akip1310				#	Используемая нагрузка(ки)
				define Load_Max_Curr			360						#	Максимально допустимый ток нагрузки
				define Load_Max_Volt			60						#	Максимально допустимое напряжение на нагрузке
				define Load_Max_Power			1,8k					#	Максимальная рассеиваемая мощность
				if	mem_1000 <= 30															#	Максимальный ток меньше 30
					DriverSet	Keithley7001 CLOSE = [2;4;7]  							#	замкнуть выходы 2, 4, 7 для установки предела измерений в 30А
				Else
					DriverSet	Keithley7001 CLOSE = [3;4;7]  							#	замкнуть выходы 3, 4, 7 для установки предела измерений в 300А
				Endif
			endif
			
			if mem_1 = 2
				define LOAD_MODEL				Akip1320				#	Используемая нагрузка(ки)
				define Load_Max_Curr			36						#	Максимально допустимый ток нагрузки
				define Load_Max_Volt			300						#	Максимально допустимое напряжение на нагрузке
				define Load_Max_Power			3,6k					#	Максимальная рассеиваемая мощность
				if	mem_1000 <= 30
					DriverSet	Keithley7001 CLOSE = [2;5;6]  							#	замкнуть выходы 2, 5, 6 для установки предела измерений в 30А
				Else
					DriverSet	Keithley7001 CLOSE = [3;5;6]  							#	замкнуть выходы 3, 5, 6 для установки предела измерений в 300А
				Endif
			endif
			
			if mem_1 = 3
			endscript													#	Остановить скрипт
			endif
		#endif
		
	#endif
	DriverSet	LOAD_MODEL 			RESET
EndFunction

# Функция для установки входных данных
Function START_DEFINE
     define VOLTAGE_METER                    Keithley2002               #     Эталон для измерения напряжения
     define CURRENT_METER                    Instek71000                    #     Эталон для измерения силы тока
     define PULS_METER                         Akip2402                    #     Эталон для измерения пульсаций
     define POWER_SUPPLY                         Akip1202                    #     Эталонный источник питания (Латер)
EndFunction

#Внесение данных условий поверки
function MODE_INPUT_TABLE
# Создание таблицы для условий поверки
     table clear                                                                                                          # очистка настройки наблицы 
     table row "Температура окружающего воздуха, С" checksyntax defvalue=20,0
     table row "Атмосферное давление, кПа" checksyntax defvalue=98,5
     table row "Относительная влажность окружающего воздуха, %" checksyntax defvalue=45
     table show mem_1000                                                                                                 # вывести меню
# Перенос значений из массива в переменные
     math mem_1001 = mem_1000[1]
     math mem_1002 = mem_1000[2]
     math mem_1003 = mem_1000[3]
# Занесение данных в протокол WORD
     report TEMP              mem_1001
     report PRESS          mem_1002
     report HUM               mem_1003
EndFunction

# Внешний осмотр поверяемого устройства
function VISUAL_CHECK
     message mem_1005 selectmenu_str defvalue="Соответствует" "Внешний осмотр\n Соответствует \n Не соответствует"
     if mem_1005="Соответствует"
          report VISUAL_CHECK "Соответствует п. METODIKA_OSMOTR Методики поверки"
     else
          report VISUAL_CHECK "Не соответствует п. METODIKA_OSMOTR Методики поверки"
          report result "не годным"
          Endscript
     endif
endfunction

#Опробование прибора
function OPROBIROVANIE
     message mem_1006 selectmenu_str defvalue="Соответствует" "Опробование\n Соответствует \n Не соответствует"
     if mem_1006="Соответствует"
          report OPROBIROVANIE "Соответствует п. METODIKA_OPROB Методики поверки"
     else
          report OPROBIROVANIE "Не соответствует п. METODIKA_OPROB Методики поверки"
          report result "не годным"
          EndScript
     endif
endfunction

############################ канал 1 ##################################################################################################################################

####################################
#  Диапазон выходных величин "High"
####################################

############ Определение основной погрешности установки выходного напряжения постоянного тока #########################################################################
#F/Результат ;          Диапазон;     Напряжение СИ от U_max, В;     Ток СИ от Imax, А;          Ток нагрузки от Imax, А;     Интервал жидания, с;
Function VDC_H          mem_3          mem_2001                    mem_3001                         mem_3999                         mem_69
# Установка выходного напряжения источника     
     math mem_2100 = mem_2001 * U_max                                              #     Поверяемая точка
     If Interface = true
          DriverSet Model_SI_Driver VDC = mem_2100                                                                                                        # для удаленно управляемого источника
          else
          Message mem_2100 checksyntax  defvalue=mem_2100 "Установите на источнике выходное напряжение равное mem_2100, В \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
# Считывание значения напряжения в точке     
     message wait=mem_69 "Ожидайте выполнения измерения"
     Driverget VOLTAGE_METER mem_2101 = READ                                        #     Запрос текущего значения вольтметра
# Расчет допустимой погрешности и отклонения
     math mem_2010 = VDC_coe * mem_2100 + VDC_con                              #     Допустимое отклонение для точки
     math mem_2011=mem_2101-mem_2100                                              #     Вычисления модуля отклонения между точками
     math mem_2110 = mem_2010 * 1000                                        #     Перевод в миливольты
     string mem_6666=GetField(mem_2110;".";1)
     string mem_7777=GetField(mem_2110;".";2)
          if mem_7777 = Nan
          math mem_7777 = 0
          endif
     string mem_2110= mem_6666||","||mem_7777
     string mem_2110 = &'00B1' mem_2110                                     #     Добавление знака "+/-" для отчета
# Сравнение и вывод
     math mem_2019 = abs(mem_2011)
     string mem_3 = "Канал 1 диапазон High"
     compare mem_2109 mem_2019<=mem_2010 description="ОТКЛОНЕНИЕ НЕ В ДОПУСКЕ!"      #     Определение нахождения значения в дропуске
# в отчет                     Номер канала;     Поверяемая точка, В;     Измеренное значение, В;     Отклонение, В;          Допуск, В;          Вывод о соответствии;	report VDC_MANY_CH           mem_3          mem_2100                    mem_2101                         mem_2011               mem_2110          mem_2109
	
EndFunction

############ Определение основной погрешности измерения выходного напряжения постоянного тока #########################################################################
#F/Результат ;          Диапазон;        Ток СИ от Imax, А;     Напряжение СИ от U_max, В;       Ток нагрузки от Imax, А;     Интервал жидания, с;
Function VDC_izm_H     mem_3          mem_2001                         mem_3001                         mem_3999                         mem_69
# Установка выходного напряжения источника     
     math mem_2100 = mem_2001 * U_max                                              #     Поверяемая точка
     If Interface = true
          DriverSet Model_SI_Driver VDC = mem_2100                                                                                                        # для удаленно управляемого источника
          else
          Message mem_2100 checksyntax  defvalue=mem_2100 "Установите на источнике выходное напряжение равное mem_2100, В \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
# Считывание значения напряжения в точке     
     message wait=mem_69 "Ожидайте выполнения измерения"
     Driverget VOLTAGE_METER mem_2101 = READ                                        #     Запрос текущего значения вольтметра
          If Interface = true
          DriverGet Model_SI_Driver  mem_2102 = VDC                                                                                                        # для удаленно управляемого источника
     else
     Message mem_2102 checksyntax  defvalue=0 "Укажите значение напряжения измеренное внутренним измерителем источника"          # для источника без интерфейса     
     endif

# Расчет допустимой погрешности и отклонения
     math mem_2010 = VDCch1_izm_coe * mem_2100 + VDCch1_izm_con                              #     Допустимое отклонение для точки
     math mem_2011=mem_2101-mem_2102                                              #     Вычисления модуля отклонения между точками
     math mem_2110 = mem_2010 * 1000                                        #     Перевод в миливольты
     string mem_2110 = &'00B1' mem_2110                                     #     Добавление знака "+/-" для отчета
# Сравнение и вывод
     math mem_2019 = abs(mem_2011)
     compare mem_2109 mem_2019<=mem_2010 description="ОТКЛОНЕНИЕ НЕ В ДОПУСКЕ!"      #     Определение нахождения значения в дропуске
# в отчет                          Поверяемая точка, В;     Измеренное значение, В;          Отклонение, В;          Допуск, В;          Вывод о соответствии;
report VDC_izm                    mem_2100                    mem_2101                         mem_2011          mem_2110          mem_2109
EndFunction

############ Определение нестабильности выходного напряжения при изменении напряжения питающей сети. ###################################################################
#F/Результат ;               Диапазон;     Напряжение СИ от U_max, В;     Ток СИ от Imax, А;          Ток нагрузки от Imax, А;          Интервал жидания, с;     Напряжение питания от U_pit, В;                    
Function INSTB_U_Upit_H     mem_3          mem_2001                         mem_3001                         mem_3999                         mem_69                              mem_2140                                      
# Установка входного напряжения источника
     DriverSet POWER_SUPPLY V = U_pit
# Установка выходного напряжения источника     
     math mem_2100 = mem_2001 * U_max                                              #     Выходное напряжение источника
     If Interface = true
          DriverSet Model_SI_Driver VDC = mem_2100                                                                                                             # для удаленно управляемого источника
     else
          Message mem_2100 checksyntax  defvalue=mem_2100 "Установите на источнике выходное напряжение равное mem_2100, В \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
# Установка выходного напряжения источника     
     math mem_3100 = mem_3001 * I_max                                              #     Поверяемая точка
     If Interface = true
          DriverSet Model_SI_Driver IDC = mem_3100                                                                                                        # для удаленно управляемого источника
     else
          Message mem_3100 checksyntax  defvalue=mem_3100 "Установите на источнике выходной ток равным mem_3100, В \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
     DriverSet LOAD_MODEL Load = On                                                  #     Включение нагрузки
# Плавная подстройка напряжения входного питания (-10%)
     math mem_2140=0,9
     call NASTROIKA_PITANIA
     message wait=mem_69 "Ожидайте выполнения измерения"
     Driverget  VOLTAGE_METER mem_2101 = READ                                   #     Считать показания мультиметра

# Плавная подстройка напряжения входного питания (+10%)
     math mem_2140=1,1
     call NASTROIKA_PITANIA     
     message wait=mem_69 "Ожидайте выполнения измерения"
     Driverget  VOLTAGE_METER mem_2102 = READ                                   #     Считать показания мультиметра
     DriverSet LOAD_MODEL Load = Off                                                  #     Выключение нагрузки
# Расчет допустимой погрешности и отклонения
     math mem_2010 = VDCpit_coe * mem_2100 + VDCpit_con                         #     Допустимое отклонение для точки
     math mem_2110 = mem_2010 * 1000                                      #     Перевод в миливольты
     string mem_2110 = &'00B1' mem_2110                                     #     Добавление знака "+/-" для отчета
     math mem_2011 = abs(mem_2101-mem_2102)                                              #     Вычисления модуля отклонения между точками
     string mem_3 = "Канал 1 диапазон High"
     # Сравнение и вывод
     compare mem_2109 mem_2011<=mem_2010 description="ОТКЛОНЕНИЕ НЕ В ДОПУСКЕ!"      #     Определение нахождения значения в дропуске
# в отчет                          Номер канала;     Напряжение питания, В;     Поверяемая точка, В;     Измерение 1, В;     Измерение 2, В;     Нестабильность, В;     Допуск, В;          Вывод о соответствии;
report INSTB_U_Upit_MANY_CH     mem_3               "198 - 242"                    mem_2100                    mem_2101               mem_2102               mem_2011                    mem_2110          mem_2109
EndFunction

############ Определение нестабильности выходного напряжения при изменении тока нагрузки. ##############################################################################
#F/Результат;                Диапазон;     Напряжение СИ от U_max, В;     Ток СИ от Imax, А;          Ток нагрузки от Imax, А;          Интервал жидания, с;     Выходной ток от I_max 2, В;                    
Function INSTB_U_Inagr_H     mem_3          mem_2001                         mem_3001                         mem_3999                         mem_69                              mem_3997
# Установка тока нагрузки     
          math mem_3998 = mem_3999 * I_max
          call TOK_NAGRUZKI
# Установка выходного напряжения источника     
     math mem_2100 = mem_2001 * U_max                                             #     Поверяемая точка
     If Interface = true
          DriverSet Model_SI_Driver VDC = mem_2100                                                                                                            # для удаленно управляемого источника
          else
          Message mem_2100 checksyntax  defvalue=mem_2100 "Установите на источнике выходное напряжение равное mem_2100, В \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
# Считывание значения напряжения в точке с нагрузкой     
     DriverSet LOAD_MODEL Load = On                                                  #     Включение нагрузки
     message wait=mem_69 "Ожидайте выполнения измерения"
     Driverget  VOLTAGE_METER mem_2101 = READ                                   #     Считать показания мультиметра с нагрузкой
               if mem_3999 != mem_3997     
               # Считывание значения напряжения в точке без нагрузки     
                    math mem_3998 = mem_3997 * I_max
                    call TOK_NAGRUZKI                                                  #     Установка тока нагрузки               
                    message wait=mem_69 "Ожидайте выполнения измерения"
                    Driverget  VOLTAGE_METER mem_2102 = READ                    #     Считать показания мультиметра без нагрузки
                    math mem_2011 = mem_2102-mem_2101                               #     Вычисления отклонения между точками
                    math mem_2019 = abs(mem_2011)                                   #     Вычисления модуля отклонения
               Else
                    math mem_2011 = mem_2101-mem_2100                              #     Вычисления отклонения между точками
                    math mem_2019 = abs(mem_2011)                                   #     Вычисления модуля отклонения
                    string mem_2102 = "не измерялось в соотв. с методикой"
               Endif
# Расчет допустимой погрешности и отклонения
     math mem_3990 = mem_3999 * I_max
     math mem_2010 = VDCnagr_coe * mem_2100 + VDCnagr_con                    #     Допустимое отклонение для точки
     math mem_2110 = mem_2010 * 1000                                      #     Перевод в миливольты
     string mem_6666=GetField(mem_2110;".";1)
     string mem_7777=GetField(mem_2110;".";2)
          if mem_7777 = Nan
          math mem_7777 = 0
          endif
     string mem_2110= mem_6666||","||mem_7777
     string mem_2110=&'00B1' mem_2110                                       #     Добавление знака "+/-" для отчета
     string mem_3 = "Канал 1 диапазон High"
     # Сравнение и вывод
     compare mem_2109 mem_2019<=mem_2010 description="ОТКЛОНЕНИЕ НЕ В ДОПУСКЕ!"      #     Определение нахождения значения в дропуске
# в отчет                               Номер канала;     Поверяемая точка, В;     Показание источника с нагрузкой, В; Ток в нагрузке, А;     Показание источника без нагрузки, В;     Расчетная нестабильность;     Допуск;     Вывод о соответствии;
report INSTB_U_Inagr_MANY_CH          mem_3               mem_2100                    mem_2101                              mem_3990                         mem_2102                                             mem_2019                         mem_2110     mem_2109
EndFunction

############ Определение абсолютной погрешности формирования силы выходного тока. ######################################################################################
#F/Результат;               Диапазон;     Ток СИ от Imax, А;     Напряжение СИ от U_max, В;     Ток нагрузки от Imax, А;          Интервал жидания, с;     
Function IDC_H         	 mem_3         			 mem_3001               mem_2001                         mem_3999                         mem_69                                   
# Установка выходного тока источника     
     math mem_3100 = mem_3001 * I_max                                              #     Поверяемая точка
     If Interface = true
          DriverSet Model_SI_Driver IDC = mem_3100                                                                               # для удаленно управляемого источника
          else
          Message mem_3100 checksyntax  defvalue=mem_3100 "Установите на источнике выходной ток равным mem_3100, А \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
     # Установка тока нагрузки     
     math mem_3998 = mem_3999 * I_max                                             #     Значение тока нагрузки в точке
     call TOK_NAGRUZKI
# Считывание значения тока в точке     
     message wait=mem_69 "Ожидайте выполнения измерения"
     Driverget  CURRENT_METER mem_3101 = IDC                                        #      Считать показания мультиметра (ток)
# Расчет допустимой погрешности и отклонения     
     math mem_3010 = IDC_coe * mem_3100 + IDC_con                              #     Допустимое отклонение для точки
     math mem_3110 = mem_3010 * 1000                                         #     Перевод в милиамперы
     string mem_6666=GetField(mem_3110;".";1)
     string mem_7777=GetField(mem_3110;".";2)
          if mem_7777 = Nan
          math mem_7777 = 0
          endif
     string mem_3110= mem_6666||","||mem_7777
     string mem_3110 = &'00B1' mem_3110                                      #     Добавление знака "+/-" для отчета
     math mem_3011 = mem_3101-mem_3100                                              #     Вычисления модуля отклонения для точки
     string mem_3 = "Канал 1 диапазон High"
     # Сравнение и вывод
     math mem_3019 = abs(mem_3011)
     compare mem_3109 mem_3019<=mem_3010 description="ОТКЛОНЕНИЕ НЕ В ДОПУСКЕ!"     #      Определение нахождения значения в дропуске
# в отчет                     Номер канала;     Поверяемая точка, А;     Показание источника, А;          Погрешность;     Допуск;          Вывод о соответствии;
report IDC_MANY_CH      mem_3                    mem_3100                    mem_3101                         mem_3011          mem_3110          mem_3109     
EndFunction

############ Определение абсолютной погрешности формирования силы выходного тока. ######################################################################################
#F/Результат;               Диапазон;      Напряжение СИ от U_max, В;   Ток СИ от Imax, А;      Ток нагрузки от Imax, А;          Интервал жидания, с;     
Function IDC_izm_H     mem_3          mem_3001                         mem_2001                         mem_3999                         mem_69                                   
# Установка выходного тока источника     
     math mem_3100 = mem_3001 * I_max                                             #     Поверяемая точка
     If Interface = true
          DriverSet Model_SI_Driver IDC = mem_3100                                                                               # для удаленно управляемого источника
     else
          Message mem_3100 checksyntax  defvalue=mem_3100 "Установите на источнике выходной ток равный mem_3100 ,А \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
# Считывание значения тока в точке     
     message wait=mem_69 "Ожидайте выполнения измерения"
     Driverget  CURRENT_METER mem_3101 = IDC                                        #      Считать показания мультиметра (ток)
                    If Interface = true
          DriverGet Model_SI_Driver mem_3102= IDC                                                                            # для удаленно управляемого источника
     else
     Message mem_3102 checksyntax  defvalue=0 "Укажите значение тока измеренное внутренним измерителем источника"          # для источника без интерфейса     
     endif
# Расчет допустимой погрешности и отклонения     
     math mem_3010 = IDCch1_izm_coe * mem_3100 + IDCch1_izm_con                              #     Допустимое отклонение для точки
     math mem_3110 = mem_3010 * 1000                                         #     Перевод в милиамперы
     string mem_3110 = &'00B1' mem_3110                                      #     Добавление знака "+/-" для отчета
     math mem_3011 = mem_3101-mem_3102                                              #     Вычисления модуля отклонения для точки
     # Сравнение и вывод
     math mem_3019 = abs(mem_3011)
     compare mem_3109 mem_3019<=mem_3010 description="ОТКЛОНЕНИЕ НЕ В ДОПУСКЕ!"     #      Определение нахождения значения в дропуске
# в отчет                          Поверяемая точка, А;     Показание источника, А;          Погрешность;     Допуск;          Вывод о соответствии;
report IDC_izm                    mem_3100                    mem_3101                         mem_3011          mem_3110          mem_3109
EndFunction

############ Определение нестабильности выходного тока при изменении напряжения питающей сети. ######################################################################### 
#F/Результат;               Диапазон;     Ток СИ от Imax, А;     Напряжение СИ от U_max, В;      Ток нагрузки от Imax, А;          Интервал жидания, с;     Напряжение питания от U_pit, В;          
Function INSTB_I_Upit_H     mem_3           mem_3001                    mem_2001                         mem_3999                         mem_69                              mem_2140                                    
# Установка входного напряжения источника
     DriverSet POWER_SUPPLY V = U_pit
# Установка выходного напряжения источника     
     DriverSet LOAD_MODEL Load = Off
     math mem_2100 = mem_2001 * U_max
     If Interface = true
          DriverSet Model_SI_Driver VDC = mem_2100                                                                                                            # для удаленно управляемого источника
          else
          Message mem_2100 checksyntax  defvalue=mem_2100 "Установите на источнике выходное напряжение равное mem_2100, В \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
# Установка выходного тока источника     
     math mem_3100 = mem_3001 * I_max                                              
     If Interface = true
          DriverSet Model_SI_Driver IDC = mem_3100                                                                               # для удаленно управляемого источника
          else
          Message mem_3100 checksyntax  defvalue=mem_3100 "Установите на источнике выходной ток равным mem_3100, А \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
     # Установка тока нагрузки     
     DriverSet LOAD_MODEL Load = On                                                  #     Включение нагрузки
     math mem_3998 = mem_3999 * I_max
     call TOK_NAGRUZKI

# Плавная подстройка напряжения входного питания (-10%)
     math mem_2140=0,9
     call NASTROIKA_PITANIA
     message wait=mem_69 "Ожидайте выполнения измерения"
     Driverget  CURRENT_METER mem_3101 = IDC                                        #      Считать показания мультиметра (ток)

# Плавная подстройка напряжения входного питания (+10%)
     math mem_2140=1,1
     call NASTROIKA_PITANIA
     message wait=mem_69 "Ожидайте выполнения измерения"     
     Driverget  CURRENT_METER mem_3102 = IDC                                        #      Считать показания мультиметра (ток)
# Расчет допустимой погрешности и отклонения     
     math mem_3010 = IDCpit_coe * mem_3100 + IDCpit_con                         #     Допустимое отклонение для точки
     math mem_3110 = mem_3010 * 1000                                      #     Перевод в милиамперы
     string mem_3110 = &'00B1' mem_3110                                      #     Добавление знака "+/-" для отчета
     math mem_3011 = abs(mem_3102-mem_3101)                                              #     Вычисления модуля отклонения между точками
     string mem_3 = "Канал 1 диапазон High"
     # Сравнение и вывод
     compare mem_3109 mem_3011<=mem_3010 description="ОТКЛОНЕНИЕ НЕ В ДОПУСКЕ!"     #      Определение нахождения значения в дропуске
# в отчет                               Номер канала;     Напряжение питания, В;     Поверяемая точка, А;     Измерение 1, В;     Измерение 2, В;     Нестабильность;     Допуск;     Вывод о соответствии;
report INSTB_I_Upit_MANY_CH          mem_3               "198 - 242"                         mem_3100               mem_3101               mem_3102               mem_3011          mem_3110               mem_3109
EndFunction

############ Определение нестабильности выходного тока при изменении выходного напряжения. #############################################################################
#F/Результат;               Диапазон;     Ток СИ от Imax, А;     Напряжение СИ от U_max, В;     Ток нагрузки от Imax, А;          Интервал жидания, с;     Выходное напряжение от U_max 2, В;
Function INSTB_I_Unagr_H     mem_3          mem_3001                    mem_2001                            mem_3999                         mem_69                              mem_2003                                 
     # Установка выходного напряжения источника     
     DriverSet LOAD_MODEL Load = Off
     math mem_2100 = mem_2001 * U_max
     If Interface = true
          DriverSet Model_SI_Driver VDC = mem_2100                                                                                                            # для удаленно управляемого источника
          else
          Message mem_2100 checksyntax  defvalue=mem_2100 "Установите на источнике выходное напряжение равное mem_2100, В \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
     # Установка выходного тока источника     
     math mem_3100 = mem_3001 * I_max                                             
     If Interface = true
          DriverSet Model_SI_Driver IDC = mem_3100                                                                               # для удаленно управляемого источника
          else
          Message mem_3100 checksyntax  defvalue=mem_3100 "Установите на источнике выходной ток равным mem_3100, А \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
     
     # Установка тока нагрузки     
     DriverSet LOAD_MODEL Load = On                                                  #     Включение нагрузки
     math mem_3998 = mem_3999 * I_max
     call TOK_NAGRUZKI
     # Считывание значения тока в точке с нагрузкой
     DriverSet LOAD_MODEL Load = On
     message wait=mem_69 "Ожидайте выполнения измерения"
     Driverget  CURRENT_METER mem_3101 = IDC                                        #     Считать показания мультиметра с нагрузкой (ток)
          DriverSet LOAD_MODEL Load = Off
          if mem_2001 != mem_2003
          # Определение значения напряжения в нагрузке     
          math mem_2002 = U_max * mem_2003                                             #     Расчет значения напряжения в поверяемой точке
               If Interface = true
                    DriverSet Model_SI_Driver VDC = mem_2002                                                                                                            # для удаленно управляемого источника
               else
                    Message mem_2002 checksyntax  defvalue=mem_2002 "Установите на источнике выходное напряжение равное mem_2002 ,В \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
               endif
          # Считывание значения тока в точке без нагрузки     
          DriverSet LOAD_MODEL Load = On
          message wait=mem_69 "Ожидайте выполнения измерения"
          Driverget  CURRENT_METER mem_3102 = IDC                                        #     Считать показания мультиметра без нагрузки (ток)
          math mem_3011 = mem_3101-mem_3102                                         #     Вычисления модуля отклонения между точками
          math mem_3019 = abs(mem_3011)
          else
          math mem_3011 = mem_3101-mem_3100                                         #     Вычисления модуля отклонения между точками
          math mem_3019 = abs(mem_3011)                                             #     Вычисления модуля отклонения между точками
          string mem_3102 = "не измерялось в соотв. с методикой"
          endif
# Расчет допустимой погрешности и отклонения     
     math mem_3010 = IDCnagr_coe * mem_3100 + IDCnagr_con                    #     Допустимое отклонение для точки
     math mem_3110 = mem_3010 * 1000                                         #     Перевод в милиамперы
     string mem_6666=GetField(mem_3110;".";1)
     string mem_7777=GetField(mem_3110;".";2)
          if mem_7777 = Nan
          math mem_7777 = 0
          endif
     string mem_3110= mem_6666||","||mem_7777
     string mem_3110 = &'00B1' mem_3110                                     #     Добавление знака "+/-" для отчета
     string mem_3 = "Канал 1 диапазон High"
     # Сравнение и вывод
     compare mem_3109 mem_3019<=mem_3010 description="ОТКЛОНЕНИЕ НЕ В ДОПУСКЕ!"     #      Определение нахождения значения в дропуске
# в отчет                               Номер канала;     Значение тока в точке, А;     Показание источника с нагрузкой, А;     Напряжение в нагрузке, В;     Показание источника без нагрузки, А;     Нестабильность, А;     Допуск, А;     Вывод о соответствии;
report INSTB_I_Unagr_MANY_CH          mem_3               mem_3100                         mem_3101                                   mem_2100                              mem_3102                                        mem_3011          mem_3110     mem_3109
EndFunction

####################################
# Диапазон выходных величин "Low"
####################################

############ Определение основной погрешности установки выходного напряжения постоянного тока #########################################################################
#F/Результат ;          Диапазон;     Напряжение СИ от U_max, В;     Ток СИ от Imax, А;          Ток нагрузки от Imax, А;     Интервал жидания, с;
Function VDC_L          mem_3          mem_2001                    mem_3001                         mem_3999                         mem_69
# Установка выходного напряжения источника     
     math mem_2100 = mem_2001 * U2_max                                              #     Поверяемая точка
     If Interface = true
          DriverSet Model_SI_Driver VDC = mem_2100                                                                                                        # для удаленно управляемого источника
     else
          Message mem_2100 checksyntax  defvalue=mem_2100 "Установите на источнике выходное напряжение равное mem_2100, В \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
# Считывание значения напряжения в точке     
     message wait=mem_69 "Ожидайте выполнения измерения"
     Driverget VOLTAGE_METER mem_2101 = READ                                        #     Запрос текущего значения вольтметра
# Расчет допустимой погрешности и отклонения
     math mem_2010 = VDC_coe * mem_2100 + VDC_con                              #     Допустимое отклонение для точки
     math mem_2011=mem_2101-mem_2100                                              #     Вычисления модуля отклонения между точками
     math mem_2110 = mem_2010 * 1000                                        #     Перевод в миливольты
     string mem_6666=GetField(mem_2110;".";1)
     string mem_7777=GetField(mem_2110;".";2)
          if mem_7777 = Nan
          math mem_7777 = 0
          endif
     string mem_2110= mem_6666||","||mem_7777
     string mem_2110 = &'00B1' mem_2110                                     #     Добавление знака "+/-" для отчета
     string mem_3 = "Канал 1 диапазон Low"
     # Сравнение и вывод
     math mem_2019 = abs(mem_2011)
     compare mem_2109 mem_2019<=mem_2010 description="ОТКЛОНЕНИЕ НЕ В ДОПУСКЕ!"      #     Определение нахождения значения в дропуске
# в отчет                     Номер канала;     Поверяемая точка, В;     Измеренное значение, В;     Отклонение, В;          Допуск, В;          Вывод о соответствии;
report VDC_MANY_CH           mem_3          mem_2100                    mem_2101                         mem_2011               mem_2110          mem_2109
EndFunction

############ Определение основной погрешности измерения выходного напряжения постоянного тока #########################################################################
#F/Результат ;          Диапазон;         Ток СИ от Imax, А;     Напряжение СИ от U_max, В;      Ток нагрузки от Imax, А;     Интервал жидания, с;
Function VDC_izm_L     mem_3          mem_2001                         mem_3001                         mem_3999                         mem_69
# Установка выходного напряжения источника     
     math mem_2001 = mem_2001 * U2_max                                              #     Поверяемая точка
     If Interface = true
          DriverSet Model_SI_Driver VDC = mem_2001                                                                                                        # для удаленно управляемого источника
     else
          Message mem_2001 checksyntax  defvalue=mem_2001 "Установите на источнике выходное напряжение равным mem_2001, В \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
# Считывание значения напряжения в точке     
     message wait=mem_69 "Ожидайте выполнения измерения"
     Driverget VOLTAGE_METER mem_2101 = READ                                        #     Запрос текущего значения вольтметра
                    If Interface = true
          DriverGet Model_SI_Driver mem_2102= VDC                                                                            # для удаленно управляемого источника
     else
Message mem_2102 checksyntax  defvalue=0 "Укажите значение напряжения измеренное внутренним измерителем источника"          # для источника без интерфейса     
     endif
# Расчет допустимой погрешности и отклонения
     math mem_2010 = VDCch1_izm_coe * mem_2001 + VDCch1_izm_con                              #     Допустимое отклонение для точки
     math mem_2011=mem_2101-mem_2102                                              #     Вычисления модуля отклонения между точками
     math mem_2110 = mem_2010 * 1000                                        #     Перевод в миливольты
     string mem_2110 = &'00B1' mem_2110                                     #     Добавление знака "+/-" для отчета
# Сравнение и вывод
     math mem_2019 = abs(mem_2011)
     compare mem_2109 mem_2019<=mem_2010 description="ОТКЛОНЕНИЕ НЕ В ДОПУСКЕ!"      #     Определение нахождения значения в дропуске
# в отчет                          Поверяемая точка, В;     Измеренное значение, В;          Отклонение, В;          Допуск, В;          Вывод о соответствии;
report VDC_izm                    mem_2001                    mem_2101                         mem_2011          mem_2110          mem_2109
EndFunction

############ Определение нестабильности выходного напряжения при изменении напряжения питающей сети. ###################################################################
#F/Результат ;               Диапазон;     Напряжение СИ от U_max, В;     Ток СИ от Imax, А;          Ток нагрузки от Imax, А;          Интервал жидания, с;     Напряжение питания от U_pit, В;                    
Function INSTB_U_Upit_L     mem_3          mem_2001                         mem_3001                         mem_3999                         mem_69                              mem_2140                                      
# Установка входного напряжения источника
     DriverSet POWER_SUPPLY V = U_pit
# Установка выходного напряжения источника     
     math mem_2100 = mem_2001 * U2_max                                              #     Выходное напряжение источника
     If Interface = true
          DriverSet Model_SI_Driver VDC = mem_2100                                                                                                             # для удаленно управляемого источника
     else
          Message mem_2100 checksyntax  defvalue=mem_2100 "Установите на источнике выходное напряжение равное mem_2100, В \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
# Установка выходного напряжения источника     
     math mem_3100 = mem_3001 * I2_max                                              #     Поверяемая точка
     If Interface = true
          DriverSet Model_SI_Driver IDC = mem_3100                                                                                                        # для удаленно управляемого источника
     else
          Message mem_3100 checksyntax  defvalue=mem_3100 "Установите на источнике выходной ток равным mem_3100, В \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
     DriverSet LOAD_MODEL Load = On                                                  #     Включение нагрузки
# Плавная подстройка напряжения входного питания (-10%)
     math mem_2140=0,9
     call NASTROIKA_PITANIA
     message wait=mem_69 "Ожидайте выполнения измерения"
     Driverget  VOLTAGE_METER mem_2101 = READ                                   #     Считать показания мультиметра

# Плавная подстройка напряжения входного питания (+10%)
     math mem_2140=1,1
     call NASTROIKA_PITANIA     
     message wait=mem_69 "Ожидайте выполнения измерения"
     Driverget  VOLTAGE_METER mem_2102 = READ                                   #     Считать показания мультиметра
     DriverSet LOAD_MODEL Load = Off                                                  #     Выключение нагрузки
# Расчет допустимой погрешности и отклонения
     math mem_2010 = VDCpit_coe * mem_2100 + VDCpit_con                         #     Допустимое отклонение для точки
     math mem_2110 = mem_2010 * 1000                                      #     Перевод в миливольты
     string mem_2110 = &'00B1' mem_2110                                     #     Добавление знака "+/-" для отчета
     math mem_2011 = abs(mem_2101-mem_2102)                                              #     Вычисления модуля отклонения между точками
     string mem_3 = "Канал 1 диапазон Low"
     # Сравнение и вывод
     compare mem_2109 mem_2011<=mem_2010 description="ОТКЛОНЕНИЕ НЕ В ДОПУСКЕ!"      #     Определение нахождения значения в дропуске
# в отчет                          Номер канала;     Напряжение питания, В;     Поверяемая точка, В;     Измерение 1, В;     Измерение 2, В;     Нестабильность, В;     Допуск, В;          Вывод о соответствии;
report INSTB_U_Upit_MANY_CH     mem_3               "198 - 242"                    mem_2100                    mem_2101               mem_2102               mem_2011                    mem_2110          mem_2109
EndFunction

############ Определение нестабильности выходного напряжения при изменении тока нагрузки. ##############################################################################
#F/Результат;                Диапазон;     Напряжение СИ от U_max, В;     Ток СИ от Imax, А;          Ток нагрузки от Imax, А;          Интервал жидания, с;     Выходной ток от I_max 2, В;                    
Function INSTB_U_Inagr_L     mem_3          mem_2001                         mem_3001                         mem_3999                         mem_69                              mem_3997
# Установка тока нагрузки     
          math mem_3998 = mem_3999 * I2_max
          call TOK_NAGRUZKI
# Установка выходного напряжения источника     
     math mem_2100 = mem_2001 * U2_max                                             #     Поверяемая точка
     If Interface = true
          DriverSet Model_SI_Driver VDC = mem_2100                                                                                                            # для удаленно управляемого источника
          else
          Message mem_2100 checksyntax  defvalue=mem_2100 "Установите на источнике выходное напряжение равное mem_2100, В \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
# Считывание значения напряжения в точке с нагрузкой     
     DriverSet LOAD_MODEL Load = On                                                  #     Включение нагрузки
     message wait=mem_69 "Ожидайте выполнения измерения"
     Driverget  VOLTAGE_METER mem_2101 = READ                                   #     Считать показания мультиметра с нагрузкой
               if mem_3999 != mem_3997     
               # Считывание значения напряжения в точке без нагрузки     
                    math mem_3998 = mem_3997 * I2_max
                    call TOK_NAGRUZKI                                                  #     Установка тока нагрузки               
                    message wait=mem_69 "Ожидайте выполнения измерения"
                    Driverget  VOLTAGE_METER mem_2102 = READ                    #     Считать показания мультиметра без нагрузки
                    math mem_2011 = mem_2102-mem_2101                               #     Вычисления отклонения между точками
                    math mem_2019 = abs(mem_2011)                                   #     Вычисления модуля отклонения
               Else
                    math mem_2011 = mem_2101-mem_2100                              #     Вычисления отклонения между точками
                    math mem_2019 = abs(mem_2011)                                   #     Вычисления модуля отклонения
                    string mem_2102 = "не измерялось в соотв. с методикой"
               Endif
# Расчет допустимой погрешности и отклонения
     math mem_3990 = mem_3999 * I2_max
     math mem_2010 = VDCnagr_coe * mem_2100 + VDCnagr_con                    #     Допустимое отклонение для точки
     math mem_2110 = mem_2010 * 1000                                      #     Перевод в миливольты
     string mem_6666=GetField(mem_2110;".";1)
     string mem_7777=GetField(mem_2110;".";2)
          if mem_7777 = Nan
          math mem_7777 = 0
          endif
     string mem_2110= mem_6666||","||mem_7777
     string mem_2110=&'00B1' mem_2110                                       #     Добавление знака "+/-" для отчета
     string mem_3 = "Канал 1 диапазон Low"
     # Сравнение и вывод
     compare mem_2109 mem_2019<=mem_2010 description="ОТКЛОНЕНИЕ НЕ В ДОПУСКЕ!"      #     Определение нахождения значения в дропуске
# в отчет                               Номер канала;     Поверяемая точка, В;     Показание источника с нагрузкой, В; Ток в нагрузке, А;     Показание источника без нагрузки, В;     Расчетная нестабильность;     Допуск;     Вывод о соответствии;
report INSTB_U_Inagr_MANY_CH          mem_3               mem_2100                    mem_2101                              mem_3990                         mem_2102                                             mem_2019                         mem_2110     mem_2109
EndFunction

############ Определение абсолютной погрешности формирования силы выходного тока. ######################################################################################
#F/Результат;               Диапазон;     Ток СИ от Imax, А;     Напряжение СИ от U_max, В;     Ток нагрузки от Imax, А;          Интервал жидания, с;     
Function IDC_L          mem_3          mem_3001                         mem_2001                         mem_3999                         mem_69                                   
# Установка выходного тока источника     
     math mem_3100 = mem_3001 * I2_max                                              #     Поверяемая точка
     If Interface = true
          DriverSet Model_SI_Driver IDC = mem_3100                                                                               # для удаленно управляемого источника
          else
          Message mem_3100 checksyntax  defvalue=mem_3100 "Установите на источнике выходной ток равным mem_3100, А \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
     # Установка тока нагрузки     
     math mem_3998 = mem_3999 * I2_max                                             #     Значение тока нагрузки в точке
     call TOK_NAGRUZKI
# Считывание значения тока в точке     
     message wait=mem_69 "Ожидайте выполнения измерения"
     Driverget  CURRENT_METER mem_3101 = IDC                                        #      Считать показания мультиметра (ток)
# Расчет допустимой погрешности и отклонения     
     math mem_3010 = IDC_coe * mem_3100 + IDC_con                              #     Допустимое отклонение для точки
     math mem_3110 = mem_3010 * 1000                                         #     Перевод в милиамперы
     string mem_6666=GetField(mem_3110;".";1)
     string mem_7777=GetField(mem_3110;".";2)
          if mem_7777 = Nan
          math mem_7777 = 0
          endif
     string mem_3110= mem_6666||","||mem_7777
     string mem_3110 = &'00B1' mem_3110                                      #     Добавление знака "+/-" для отчета
     math mem_3011 = mem_3101-mem_3100                                              #     Вычисления модуля отклонения для точки
     string mem_3 = "Канал 1 диапазон Low"
     # Сравнение и вывод
     math mem_3019 = abs(mem_3011)
     compare mem_3109 mem_3019<=mem_3010 description="ОТКЛОНЕНИЕ НЕ В ДОПУСКЕ!"     #      Определение нахождения значения в дропуске
# в отчет                     Номер канала;     Поверяемая точка, А;     Показание источника, А;          Погрешность;     Допуск;          Вывод о соответствии;
report IDC_MANY_CH      mem_3                    mem_3100                    mem_3101                         mem_3011          mem_3110          mem_3109     
EndFunction

############ Определение абсолютной погрешности формирования силы выходного тока. ######################################################################################
#F/Результат;               Диапазон;         Напряжение СИ от U_max, В;  Ток СИ от Imax, А;    Ток нагрузки от Imax, А;          Интервал жидания, с;     
Function IDC_izm_L     mem_3          mem_3001                         mem_2001                         mem_3999                         mem_69                                   
# Установка выходного тока источника     
     math mem_3100 = mem_3001 * I2_max                                             #     Поверяемая точка
     If Interface = true
          DriverSet Model_SI_Driver IDC = mem_3100                                                                               # для удаленно управляемого источника
     else
          Message mem_3100 checksyntax  defvalue=mem_3100 "Установите на источнике выходной ток равный mem_3100 ,А \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
# Считывание значения тока в точке     
     message wait=mem_69 "Ожидайте выполнения измерения"
     Driverget  CURRENT_METER mem_3101 = IDC                                        #      Считать показания мультиметра (ток)
               If Interface = true
          DriverGet Model_SI_Driver mem_3102= IDC                                                                            # для удаленно управляемого источника
     else
Message mem_3102 checksyntax  defvalue=0 "Укажите значение тока измеренное внутренним измерителем источника"          # для источника без интерфейса     
     endif
# Расчет допустимой погрешности и отклонения     
     math mem_3010 = IDCch1_izm_coe * mem_3100 + IDCch1_izm_con                    
     math mem_3110 = mem_3010 * 1000                                         #     Перевод в милиамперы
     string mem_3110 = &'00B1' mem_3110                                      #     Добавление знака "+/-" для отчета
     math mem_3011 = mem_3101-mem_3102                                              #     Вычисления модуля отклонения для точки
# Сравнение и вывод
     math mem_3019 = abs(mem_3011)
     compare mem_3109 mem_3019<=mem_3010 description="ОТКЛОНЕНИЕ НЕ В ДОПУСКЕ!"     #      Определение нахождения значения в дропуске
# в отчет                          Поверяемая точка, А;     Показание источника, А;          Погрешность;     Допуск;          Вывод о соответствии;
report IDC_izm                    mem_3100                    mem_3101                         mem_3011          mem_3110          mem_3109
EndFunction

############ Определение нестабильности выходного тока при изменении напряжения питающей сети. ######################################################################### 
#F/Результат;               Диапазон;     Ток СИ от Imax, А;     Напряжение СИ от U_max, В;      Ток нагрузки от Imax, А;          Интервал жидания, с;     Напряжение питания от U_pit, В;          
Function INSTB_I_Upit_L     mem_3           mem_3001                    mem_2001                         mem_3999                         mem_69                              mem_2140                                    
# Установка входного напряжения источника
     DriverSet POWER_SUPPLY V = U_pit
# Установка выходного напряжения источника     
     DriverSet LOAD_MODEL Load = Off
     math mem_2100 = mem_2001 * U2_max
     If Interface = true
          DriverSet Model_SI_Driver VDC = mem_2100                                                                                                            # для удаленно управляемого источника
          else
          Message mem_2100 checksyntax  defvalue=mem_2100 "Установите на источнике выходное напряжение равное mem_2100, В \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
# Установка выходного тока источника     
     math mem_3100 = mem_3001 * I2_max                                              
     If Interface = true
          DriverSet Model_SI_Driver IDC = mem_3100                                                                               # для удаленно управляемого источника
          else
          Message mem_3100 checksyntax  defvalue=mem_3100 "Установите на источнике выходной ток равным mem_3100, А \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
     # Установка тока нагрузки     
     math mem_3998 = mem_3999 * I2_max
     call TOK_NAGRUZKI
     DriverSet LOAD_MODEL Load = On                                                  #     Включение нагрузки
# Плавная подстройка напряжения входного питания (-10%)
     math mem_2140=0,9
     call NASTROIKA_PITANIA
     message wait=mem_69 "Ожидайте выполнения измерения"
     Driverget  CURRENT_METER mem_3101 = IDC                                        #      Считать показания мультиметра (ток)

# Плавная подстройка напряжения входного питания (+10%)
     math mem_2140=1,1
     call NASTROIKA_PITANIA
     message wait=mem_69 "Ожидайте выполнения измерения"     
     Driverget  CURRENT_METER mem_3102 = IDC                                        #      Считать показания мультиметра (ток)
# Расчет допустимой погрешности и отклонения     
     math mem_3010 = IDCpit_coe * mem_3100 + IDCpit_con                         #     Допустимое отклонение для точки
     math mem_3110 = mem_3010 * 1000                                      #     Перевод в милиамперы
     string mem_3110 = &'00B1' mem_3110                                      #     Добавление знака "+/-" для отчета
     math mem_3011 = abs(mem_3102-mem_3101)                                              #     Вычисления модуля отклонения между точками
     string mem_3 = "Канал 1 диапазон Low"
     # Сравнение и вывод
     compare mem_3109 mem_3011<=mem_3010 description="ОТКЛОНЕНИЕ НЕ В ДОПУСКЕ!"     #      Определение нахождения значения в дропуске
# в отчет                               Номер канала;     Напряжение питания, В;     Поверяемая точка, А;     Измерение 1, В;     Измерение 2, В;     Нестабильность;     Допуск;     Вывод о соответствии;
report INSTB_I_Upit_MANY_CH          mem_3               "198 - 242"                         mem_3100               mem_3101               mem_3102               mem_3011          mem_3110               mem_3109
EndFunction

############ Определение нестабильности выходного тока при изменении выходного напряжения. #############################################################################
#F/Результат;               Диапазон;     Ток СИ от Imax, А;     Напряжение СИ от U_max, В;     Ток нагрузки от Imax, А;          Интервал жидания, с;     Выходное напряжение от U_max 2, В;
Function INSTB_I_Unagr_L     mem_3          mem_3001                    mem_2001                            mem_3999                         mem_69                              mem_2003                                 
     # Установка выходного напряжения источника     
     DriverSet LOAD_MODEL Load = Off
     math mem_2100 = mem_2001 * U2_max
     If Interface = true
          DriverSet Model_SI_Driver VDC = mem_2100                                                                                                            # для удаленно управляемого источника
          else
          Message mem_2100 checksyntax  defvalue=mem_2100 "Установите на источнике выходное напряжение равное mem_2100, В \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
     # Установка выходного тока источника     
     math mem_3100 = mem_3001 * I2_max                                             
     If Interface = true
          DriverSet Model_SI_Driver IDC = mem_3100                                                                               # для удаленно управляемого источника
          else
          Message mem_3100 checksyntax  defvalue=mem_3100 "Установите на источнике выходной ток равным mem_3100, А \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
     
     # Установка тока нагрузки     
     DriverSet LOAD_MODEL Load = On                                                  #     Включение нагрузки
     math mem_3998 = mem_3999 * I2_max
     call TOK_NAGRUZKI
     # Считывание значения тока в точке с нагрузкой
     DriverSet LOAD_MODEL Load = On
     message wait=mem_69 "Ожидайте выполнения измерения"
     Driverget  CURRENT_METER mem_3101 = IDC                                        #     Считать показания мультиметра с нагрузкой (ток)
          DriverSet LOAD_MODEL Load = Off
          if mem_2001 != mem_2003
          # Определение значения напряжения в нагрузке     
          math mem_2002 = U2_max * mem_2003                                             #     Расчет значения напряжения в поверяемой точке
               If Interface = true
                    DriverSet Model_SI_Driver VDC = mem_2002                                                                                                            # для удаленно управляемого источника
               else
                    Message mem_2002 checksyntax  defvalue=mem_2002 "Установите на источнике выходное напряжение равное mem_2002 ,В \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
               endif
          # Считывание значения тока в точке без нагрузки     
          DriverSet LOAD_MODEL Load = On
          message wait=mem_69 "Ожидайте выполнения измерения"
          Driverget  CURRENT_METER mem_3102 = IDC                                        #     Считать показания мультиметра без нагрузки (ток)
          math mem_3011 = mem_3101-mem_3102                                         #     Вычисления модуля отклонения между точками
          math mem_3019 = abs(mem_3011)
          else
          math mem_3011 = mem_3101-mem_3100                                         #     Вычисления модуля отклонения между точками
          math mem_3019 = abs(mem_3011)                                             #     Вычисления модуля отклонения между точками
          string mem_3102 = "не измерялось в соотв. с методикой"
          endif
# Расчет допустимой погрешности и отклонения     
     math mem_3010 = IDCnagr_coe * mem_3100 + IDCnagr_con                    #     Допустимое отклонение для точки
     math mem_3110 = mem_3010 * 1000                                         #     Перевод в милиамперы
     string mem_6666=GetField(mem_3110;".";1)
     string mem_7777=GetField(mem_3110;".";2)
          if mem_7777 = Nan
          math mem_7777 = 0
          endif
     string mem_3110= mem_6666||","||mem_7777
     string mem_3110 = &'00B1' mem_3110                                     #     Добавление знака "+/-" для отчета
     string mem_3 = "Канал 1 диапазон Low"
     # Сравнение и вывод
     compare mem_3109 mem_3019<=mem_3010 description="ОТКЛОНЕНИЕ НЕ В ДОПУСКЕ!"     #      Определение нахождения значения в дропуске
# в отчет                               Номер канала;     Значение тока в точке, А;     Показание источника с нагрузкой, А;     Напряжение в нагрузке, В;     Показание источника без нагрузки, А;     Нестабильность, А;     Допуск, А;     Вывод о соответствии;
report INSTB_I_Unagr_MANY_CH          mem_3               mem_3100                         mem_3101                                   mem_2100                              mem_3102                                        mem_3011          mem_3110     mem_3109
EndFunction

############################ канал 2 ##################################################################################################################################

####################################
#  Диапазон выходных величин "High"
####################################

############ Определение основной погрешности установки выходного напряжения постоянного тока #########################################################################
#F/Результат ;          Диапазон;     Напряжение СИ от U_max, В;     Ток СИ от Imax, А;          Ток нагрузки от Imax, А;     Интервал жидания, с;
Function VDC_H_CH2     mem_3          mem_2001                    mem_3001                         mem_3999                         mem_69
# Установка выходного напряжения источника     
     math mem_2100 = mem_2001 * U_max                                              #     Поверяемая точка
     If Interface = true
          DriverSet Model_SI_Driver VDC = mem_2100                                                                                                        # для удаленно управляемого источника
          else
          Message mem_2100 checksyntax  defvalue=mem_2100 "Установите на источнике выходное напряжение равное mem_2100, В \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
# Считывание значения напряжения в точке     
     message wait=mem_69 "Ожидайте выполнения измерения"
     Driverget VOLTAGE_METER mem_2101 = READ                                        #     Запрос текущего значения вольтметра
# Расчет допустимой погрешности и отклонения
     math mem_2010 = VDC2_coe * mem_2100 + VDC2_con                              #     Допустимое отклонение для точки
     math mem_2011=mem_2101-mem_2100                                              #     Вычисления модуля отклонения между точками
     math mem_2110 = mem_2010 * 1000                                        #     Перевод в миливольты
     string mem_6666=GetField(mem_2110;".";1)
     string mem_7777=GetField(mem_2110;".";2)
          if mem_7777 = Nan
          math mem_7777 = 0
          endif
     string mem_2110= mem_6666||","||mem_7777
     string mem_2110 = &'00B1' mem_2110                                     #     Добавление знака "+/-" для отчета
# Сравнение и вывод
     math mem_2019 = abs(mem_2011)
     string mem_3 = "Канал 2 диапазон High"
     compare mem_2109 mem_2019<=mem_2010 description="ОТКЛОНЕНИЕ НЕ В ДОПУСКЕ!"      #     Определение нахождения значения в дропуске
# в отчет                     Номер канала;     Поверяемая точка, В;     Измеренное значение, В;     Отклонение, В;          Допуск, В;          Вывод о соответствии;
report VDC_MANY_CH           mem_3          mem_2100                    mem_2101                         mem_2011               mem_2110          mem_2109
EndFunction

############ Определение основной погрешности измерения выходного напряжения постоянного тока #########################################################################
#F/Результат ;          Диапазон;        Ток СИ от Imax, А;  Напряжение СИ от U_max, В;          Ток нагрузки от Imax, А;     Интервал жидания, с;
Function VDC_izm_H_CH2     mem_3          mem_2001                         mem_3001                         mem_3999                         mem_69
# Установка выходного напряжения источника     
     math mem_2100 = mem_2001 * U_max                                              #     Поверяемая точка
     If Interface = true
          DriverSet Model_SI_Driver VDC = mem_2100                                                                                                        # для удаленно управляемого источника
          else
          Message mem_2100 checksyntax  defvalue=mem_2100 "Установите на источнике выходное напряжение равное mem_2100, В \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
# Считывание значения напряжения в точке     
     message wait=mem_69 "Ожидайте выполнения измерения"
     Driverget VOLTAGE_METER mem_2101 = READ                                        #     Запрос текущего значения вольтметра
          If Interface = true
          DriverGet Model_SI_Driver mem_2102= VDC                                                                            # для удаленно управляемого источника
     else
Message mem_2102 checksyntax  defvalue=0 "Укажите значение напряжения измеренное внутренним измерителем источника"          # для источника без интерфейса     
     endif
# Расчет допустимой погрешности и отклонения
     math mem_2010 = VDCch2_izm_coe * mem_2100 + VDCch2_izm_con                              #     Допустимое отклонение для точки
     math mem_2011=mem_2101-mem_2102                                              #     Вычисления модуля отклонения между точками
     math mem_2110 = mem_2010 * 1000                                        #     Перевод в миливольты
     string mem_2110 = &'00B1' mem_2110                                     #     Добавление знака "+/-" для отчета
# Сравнение и вывод
     math mem_2019 = abs(mem_2011)
     compare mem_2109 mem_2019<=mem_2010 description="ОТКЛОНЕНИЕ НЕ В ДОПУСКЕ!"      #     Определение нахождения значения в дропуске
# в отчет                          Поверяемая точка, В;     Измеренное значение, В;          Отклонение, В;          Допуск, В;          Вывод о соответствии;
report VDC_izm                    mem_2100                    mem_2101                         mem_2011          mem_2110          mem_2109
EndFunction

############ Определение нестабильности выходного напряжения при изменении напряжения питающей сети. ###################################################################
#F/Результат ;               Диапазон;     Напряжение СИ от U_max, В;     Ток СИ от Imax, А;          Ток нагрузки от Imax, А;          Интервал жидания, с;     Напряжение питания от U_pit, В;                    
Function INSTB_U_Upit_H_CH2     mem_3          mem_2001                         mem_3001                         mem_3999                         mem_69                              mem_2140                                      
# Установка входного напряжения источника
     DriverSet POWER_SUPPLY V = U_pit
# Установка выходного напряжения источника     
     math mem_2100 = mem_2001 * U_max                                              #     Выходное напряжение источника
     If Interface = true
          DriverSet Model_SI_Driver VDC = mem_2100                                                                                                             # для удаленно управляемого источника
     else
          Message mem_2100 checksyntax  defvalue=mem_2100 "Установите на источнике выходное напряжение равное mem_2100, В \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
# Установка выходного напряжения источника     
     math mem_3100 = mem_3001 * I_max                                              #     Поверяемая точка
     If Interface = true
          DriverSet Model_SI_Driver IDC = mem_3100                                                                                                        # для удаленно управляемого источника
     else
          Message mem_3100 checksyntax  defvalue=mem_3100 "Установите на источнике выходной ток равным mem_3100, В \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
     DriverSet LOAD_MODEL Load = On                                                  #     Включение нагрузки
# Плавная подстройка напряжения входного питания (-10%)
     math mem_2140=0,9
     call NASTROIKA_PITANIA
     message wait=mem_69 "Ожидайте выполнения измерения"
     Driverget  VOLTAGE_METER mem_2101 = READ                                   #     Считать показания мультиметра

# Плавная подстройка напряжения входного питания (+10%)
     math mem_2140=1,1
     call NASTROIKA_PITANIA     
     message wait=mem_69 "Ожидайте выполнения измерения"
     Driverget  VOLTAGE_METER mem_2102 = READ                                   #     Считать показания мультиметра
     DriverSet LOAD_MODEL Load = Off                                                  #     Выключение нагрузки
# Расчет допустимой погрешности и отклонения
     math mem_2010 = VDCpit_coe * mem_2100 + VDCpit_con                         #     Допустимое отклонение для точки
     math mem_2110 = mem_2010 * 1000                                      #     Перевод в миливольты
     string mem_2110 = &'00B1' mem_2110                                     #     Добавление знака "+/-" для отчета
     math mem_2011 = abs(mem_2101-mem_2102)                                              #     Вычисления модуля отклонения между точками
     string mem_3 = "Канал 2 диапазон High"
     # Сравнение и вывод
     compare mem_2109 mem_2011<=mem_2010 description="ОТКЛОНЕНИЕ НЕ В ДОПУСКЕ!"      #     Определение нахождения значения в дропуске
# в отчет                          Номер канала;     Напряжение питания, В;     Поверяемая точка, В;     Измерение 1, В;     Измерение 2, В;     Нестабильность, В;     Допуск, В;          Вывод о соответствии;
report INSTB_U_Upit_MANY_CH     mem_3               "198 - 242"                    mem_2100                    mem_2101               mem_2102               mem_2011                    mem_2110          mem_2109
EndFunction

############ Определение нестабильности выходного напряжения при изменении тока нагрузки. ##############################################################################
#F/Результат;                          Диапазон;     Напряжение СИ от U_max, В;     Ток СИ от Imax, А;          Ток нагрузки от Imax, А;          Интервал жидания, с;     Выходной ток от I_max 2, В;                    
Function INSTB_U_Inagr_H_CH2     mem_3          mem_2001                         mem_3001                         mem_3999                         mem_69                              mem_3997
# Установка тока нагрузки     
          math mem_3998 = mem_3999 * I_max
          call TOK_NAGRUZKI
# Установка выходного напряжения источника     
     math mem_2100 = mem_2001 * U_max                                             #     Поверяемая точка
     If Interface = true
          DriverSet Model_SI_Driver VDC = mem_2100                                                                                                            # для удаленно управляемого источника
          else
          Message mem_2100 checksyntax  defvalue=mem_2100 "Установите на источнике выходное напряжение равное mem_2100, В \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
# Считывание значения напряжения в точке с нагрузкой     
     DriverSet LOAD_MODEL Load = On                                                  #     Включение нагрузки
     message wait=mem_69 "Ожидайте выполнения измерения"
     Driverget  VOLTAGE_METER mem_2101 = READ                                   #     Считать показания мультиметра с нагрузкой
               if mem_3999 != mem_3997     
               # Считывание значения напряжения в точке без нагрузки     
                    math mem_3998 = mem_3997 * I_max
                    call TOK_NAGRUZKI                                                  #     Установка тока нагрузки               
                    message wait=mem_69 "Ожидайте выполнения измерения"
                    Driverget  VOLTAGE_METER mem_2102 = READ                    #     Считать показания мультиметра без нагрузки
                    math mem_2011 = mem_2102-mem_2101                               #     Вычисления отклонения между точками
                    math mem_2019 = abs(mem_2011)                                   #     Вычисления модуля отклонения
               Else
                    math mem_2011 = mem_2101-mem_2100                              #     Вычисления отклонения между точками
                    math mem_2019 = abs(mem_2011)                                   #     Вычисления модуля отклонения
                    string mem_2102 = "не измерялось в соотв. с методикой"
               Endif
# Расчет допустимой погрешности и отклонения
     math mem_3990 = mem_3999 * I_max
     math mem_2010 = VDCnagr_coe * mem_2100 + VDCnagr_con                    #     Допустимое отклонение для точки
     math mem_2110 = mem_2010 * 1000                                      #     Перевод в миливольты
     string mem_6666=GetField(mem_2110;".";1)
     string mem_7777=GetField(mem_2110;".";2)
          if mem_7777 = Nan
          math mem_7777 = 0
          endif
     string mem_2110= mem_6666||","||mem_7777
     string mem_2110=&'00B1' mem_2110                                       #     Добавление знака "+/-" для отчета
     string mem_3 = "Канал 2 диапазон High"
     # Сравнение и вывод
     compare mem_2109 mem_2019<=mem_2010 description="ОТКЛОНЕНИЕ НЕ В ДОПУСКЕ!"      #     Определение нахождения значения в дропуске
# в отчет                               Номер канала;     Поверяемая точка, В;     Показание источника с нагрузкой, В; Ток в нагрузке, А;     Показание источника без нагрузки, В;     Расчетная нестабильность;     Допуск;     Вывод о соответствии;
report INSTB_U_Inagr_MANY_CH          mem_3               mem_2100                    mem_2101                              mem_3990                         mem_2102                                             mem_2019                         mem_2110     mem_2109
EndFunction

############ Определение абсолютной погрешности формирования силы выходного тока. ######################################################################################
#F/Результат;               Диапазон;     Ток СИ от Imax, А;     Напряжение СИ от U_max, В;     Ток нагрузки от Imax, А;          Интервал жидания, с;     
Function IDC_H_CH2          mem_3          mem_3001                         mem_2001                         mem_3999                         mem_69                                   
# Установка выходного тока источника     
     math mem_3100 = mem_3001 * I_max                                              #     Поверяемая точка
     If Interface = true
          DriverSet Model_SI_Driver IDC = mem_3100                                                                               # для удаленно управляемого источника
          else
          Message mem_3100 checksyntax  defvalue=mem_3100 "Установите на источнике выходной ток равным mem_3100, А \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
     # Установка тока нагрузки     
     math mem_3998 = mem_3999 * I_max                                             #     Значение тока нагрузки в точке
     call TOK_NAGRUZKI
# Считывание значения тока в точке     
     message wait=mem_69 "Ожидайте выполнения измерения"
     Driverget  CURRENT_METER mem_3101 = IDC                                        #      Считать показания мультиметра (ток)
# Расчет допустимой погрешности и отклонения     
     math mem_3010 = IDC_coe * mem_3100 + IDC_con                              #     Допустимое отклонение для точки
     math mem_3110 = mem_3010 * 1000                                         #     Перевод в милиамперы
     string mem_6666=GetField(mem_3110;".";1)
     string mem_7777=GetField(mem_3110;".";2)
          if mem_7777 = Nan
          math mem_7777 = 0
          endif
     string mem_3110= mem_6666||","||mem_7777
     string mem_3110 = &'00B1' mem_3110                                      #     Добавление знака "+/-" для отчета
     math mem_3011 = mem_3101-mem_3100                                              #     Вычисления модуля отклонения для точки
     string mem_3 = "Канал 2 диапазон High"
     # Сравнение и вывод
     math mem_3019 = abs(mem_3011)
     compare mem_3109 mem_3019<=mem_3010 description="ОТКЛОНЕНИЕ НЕ В ДОПУСКЕ!"     #      Определение нахождения значения в дропуске
# в отчет                     Номер канала;     Поверяемая точка, А;     Показание источника, А;          Погрешность;     Допуск;          Вывод о соответствии;
report IDC_MANY_CH      mem_3                    mem_3100                    mem_3101                         mem_3011          mem_3110          mem_3109     
EndFunction

############ Определение абсолютной погрешности формирования силы выходного тока. ######################################################################################
#F/Результат;               Диапазон;          Напряжение СИ от U_max, В; Ток СИ от Imax, А;    Ток нагрузки от Imax, А;          Интервал жидания, с;     
Function IDC_izm_H_CH2     mem_3          mem_3001                         mem_2001                         mem_3999                         mem_69                                   
# Установка выходного тока источника     
     math mem_3100 = mem_3001 * I_max                                             #     Поверяемая точка
     If Interface = true
          DriverSet Model_SI_Driver IDC = mem_3100                                                                               # для удаленно управляемого источника
     else
          Message mem_3100 checksyntax  defvalue=mem_3100 "Установите на источнике выходной ток равный mem_3100 ,А \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
# Считывание значения тока в точке     
     message wait=mem_69 "Ожидайте выполнения измерения"
     Driverget  CURRENT_METER mem_3101 = IDC                                        #      Считать показания мультиметра (ток)
                    If Interface = true
          DriverGet Model_SI_Driver mem_3102= IDC                                                                            # для удаленно управляемого источника
     else
Message mem_3102 checksyntax  defvalue=0 "Укажите значение тока измеренное внутренним измерителем источника"          # для источника без интерфейса     
     endif
# Расчет допустимой погрешности и отклонения     
     math mem_3010 = IDCch2_izm_coe * mem_3100 + IDCch2_izm_con                              #     Допустимое отклонение для точки
     math mem_3110 = mem_3010 * 1000                                         #     Перевод в милиамперы
     string mem_3110 = &'00B1' mem_3110                                      #     Добавление знака "+/-" для отчета
     math mem_3011 = mem_3101-mem_3102                                              #     Вычисления модуля отклонения для точки
     # Сравнение и вывод
     math mem_3019 = abs(mem_3011)
     compare mem_3109 mem_3019<=mem_3010 description="ОТКЛОНЕНИЕ НЕ В ДОПУСКЕ!"     #      Определение нахождения значения в дропуске
# в отчет                          Поверяемая точка, А;     Показание источника, А;          Погрешность;     Допуск;          Вывод о соответствии;
report IDC_izm                    mem_3100                    mem_3101                         mem_3011          mem_3110          mem_3109
EndFunction

############ Определение нестабильности выходного тока при изменении напряжения питающей сети. ######################################################################### 
#F/Результат;                    Диапазон;     Ток СИ от Imax, А;     Напряжение СИ от U_max, В;      Ток нагрузки от Imax, А;          Интервал жидания, с;     Напряжение питания от U_pit, В;          
Function INSTB_I_Upit_H_CH2     mem_3           mem_3001                    mem_2001                         mem_3999                         mem_69                              mem_2140                                    
# Установка входного напряжения источника
     DriverSet POWER_SUPPLY V = U_pit
# Установка выходного напряжения источника     
     DriverSet LOAD_MODEL Load = Off
     math mem_2100 = mem_2001 * U_max
     If Interface = true
          DriverSet Model_SI_Driver VDC = mem_2100                                                                                                            # для удаленно управляемого источника
          else
          Message mem_2100 checksyntax  defvalue=mem_2100 "Установите на источнике выходное напряжение равное mem_2100, В \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
# Установка выходного тока источника     
     math mem_3100 = mem_3001 * I_max                                              
     If Interface = true
          DriverSet Model_SI_Driver IDC = mem_3100                                                                               # для удаленно управляемого источника
          else
          Message mem_3100 checksyntax  defvalue=mem_3100 "Установите на источнике выходной ток равным mem_3100, А \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
     # Установка тока нагрузки     
     DriverSet LOAD_MODEL Load = On                                                  #     Включение нагрузки
     math mem_3998 = mem_3999 * I_max
     call TOK_NAGRUZKI

# Плавная подстройка напряжения входного питания (-10%)
     math mem_2140=0,9
     call NASTROIKA_PITANIA
     message wait=mem_69 "Ожидайте выполнения измерения"
     Driverget  CURRENT_METER mem_3101 = IDC                                        #      Считать показания мультиметра (ток)

# Плавная подстройка напряжения входного питания (+10%)
     math mem_2140=1,1
     call NASTROIKA_PITANIA
     message wait=mem_69 "Ожидайте выполнения измерения"     
     Driverget  CURRENT_METER mem_3102 = IDC                                        #      Считать показания мультиметра (ток)
# Расчет допустимой погрешности и отклонения     
     math mem_3010 = IDCpit_coe * mem_3100 + IDCpit_con                         #     Допустимое отклонение для точки
     math mem_3110 = mem_3010 * 1000                                      #     Перевод в милиамперы
     string mem_3110 = &'00B1' mem_3110                                      #     Добавление знака "+/-" для отчета
     math mem_3011 = abs(mem_3102-mem_3101)                                              #     Вычисления модуля отклонения между точками
     string mem_3 = "Канал 2 диапазон High"
     # Сравнение и вывод
     compare mem_3109 mem_3011<=mem_3010 description="ОТКЛОНЕНИЕ НЕ В ДОПУСКЕ!"     #      Определение нахождения значения в дропуске
# в отчет                               Номер канала;     Напряжение питания, В;     Поверяемая точка, А;     Измерение 1, В;     Измерение 2, В;     Нестабильность;     Допуск;     Вывод о соответствии;
report INSTB_I_Upit_MANY_CH          mem_3               "198 - 242"                         mem_3100               mem_3101               mem_3102               mem_3011          mem_3110               mem_3109
EndFunction

############ Определение нестабильности выходного тока при изменении выходного напряжения. #############################################################################
#F/Результат;               Диапазон;     Ток СИ от Imax, А;     Напряжение СИ от U_max, В;     Ток нагрузки от Imax, А;          Интервал жидания, с;     Выходное напряжение от U_max 2, В;
Function INSTB_I_Unagr_H_CH2     mem_3          mem_3001                    mem_2001                            mem_3999                         mem_69                              mem_2003                                 
     # Установка выходного напряжения источника     
     DriverSet LOAD_MODEL Load = Off
     math mem_2100 = mem_2001 * U_max
     If Interface = true
          DriverSet Model_SI_Driver VDC = mem_2100                                                                                                            # для удаленно управляемого источника
          else
          Message mem_2100 checksyntax  defvalue=mem_2100 "Установите на источнике выходное напряжение равное mem_2100, В \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
     # Установка выходного тока источника     
     math mem_3100 = mem_3001 * I_max                                             
     If Interface = true
          DriverSet Model_SI_Driver IDC = mem_3100                                                                               # для удаленно управляемого источника
          else
          Message mem_3100 checksyntax  defvalue=mem_3100 "Установите на источнике выходной ток равным mem_3100, А \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
     
     # Установка тока нагрузки     
     DriverSet LOAD_MODEL Load = On                                                  #     Включение нагрузки
     math mem_3998 = mem_3999 * I_max
     call TOK_NAGRUZKI
     # Считывание значения тока в точке с нагрузкой
     DriverSet LOAD_MODEL Load = On
     message wait=mem_69 "Ожидайте выполнения измерения"
     Driverget  CURRENT_METER mem_3101 = IDC                                        #     Считать показания мультиметра с нагрузкой (ток)
          DriverSet LOAD_MODEL Load = Off
          if mem_2001 != mem_2003
          # Определение значения напряжения в нагрузке     
          math mem_2002 = U_max * mem_2003                                             #     Расчет значения напряжения в поверяемой точке
               If Interface = true
                    DriverSet Model_SI_Driver VDC = mem_2002                                                                                                            # для удаленно управляемого источника
               else
                    Message mem_2002 checksyntax  defvalue=mem_2002 "Установите на источнике выходное напряжение равное mem_2002 ,В \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
               endif
          # Считывание значения тока в точке без нагрузки     
          DriverSet LOAD_MODEL Load = On
          message wait=mem_69 "Ожидайте выполнения измерения"
          Driverget  CURRENT_METER mem_3102 = IDC                                        #     Считать показания мультиметра без нагрузки (ток)
          math mem_3011 = mem_3101-mem_3102                                         #     Вычисления модуля отклонения между точками
          math mem_3019 = abs(mem_3011)
          else
          math mem_3011 = mem_3101-mem_3100                                         #     Вычисления модуля отклонения между точками
          math mem_3019 = abs(mem_3011)                                             #     Вычисления модуля отклонения между точками
          string mem_3102 = "не измерялось в соотв. с методикой"
          endif
# Расчет допустимой погрешности и отклонения     
     math mem_3010 = IDCnagr_coe * mem_3100 + IDCnagr_con                    #     Допустимое отклонение для точки
     math mem_3110 = mem_3010 * 1000                                         #     Перевод в милиамперы
     string mem_6666=GetField(mem_3110;".";1)
     string mem_7777=GetField(mem_3110;".";2)
          if mem_7777 = Nan
          math mem_7777 = 0
          endif
     string mem_3110= mem_6666||","||mem_7777
     string mem_3110 = &'00B1' mem_3110                                     #     Добавление знака "+/-" для отчета
     string mem_3 = "Канал 2 диапазон High"
     # Сравнение и вывод
     compare mem_3109 mem_3019<=mem_3010 description="ОТКЛОНЕНИЕ НЕ В ДОПУСКЕ!"     #      Определение нахождения значения в дропуске
# в отчет                               Номер канала;     Значение тока в точке, А;     Показание источника с нагрузкой, А;     Напряжение в нагрузке, В;     Показание источника без нагрузки, А;     Нестабильность, А;     Допуск, А;     Вывод о соответствии;
report INSTB_I_Unagr_MANY_CH          mem_3               mem_3100                         mem_3101                                   mem_2100                              mem_3102                                        mem_3011          mem_3110     mem_3109
EndFunction

####################################
# Диапазон выходных величин "Low"
####################################

############ Определение основной погрешности установки выходного напряжения постоянного тока #########################################################################
#F/Результат ;          Диапазон;     Напряжение СИ от U_max, В;     Ток СИ от Imax, А;          Ток нагрузки от Imax, А;     Интервал жидания, с;
Function VDC_L_CH2          mem_3          mem_2001                    mem_3001                         mem_3999                         mem_69
# Установка выходного напряжения источника     
     math mem_2100 = mem_2001 * U2_max                                              #     Поверяемая точка
     If Interface = true
          DriverSet Model_SI_Driver VDC = mem_2100                                                                                                        # для удаленно управляемого источника
     else
          Message mem_2100 checksyntax  defvalue=mem_2100 "Установите на источнике выходное напряжение равное mem_2100, В \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
# Считывание значения напряжения в точке     
     message wait=mem_69 "Ожидайте выполнения измерения"
     Driverget VOLTAGE_METER mem_2101 = READ                                        #     Запрос текущего значения вольтметра
# Расчет допустимой погрешности и отклонения
     math mem_2010 = VDC2_coe * mem_2100 + VDC2_con                              #     Допустимое отклонение для точки
     math mem_2011=mem_2101-mem_2100                                              #     Вычисления модуля отклонения между точками
     math mem_2110 = mem_2010 * 1000                                        #     Перевод в миливольты
     string mem_6666=GetField(mem_2110;".";1)
     string mem_7777=GetField(mem_2110;".";2)
          if mem_7777 = Nan
          math mem_7777 = 0
          endif
     string mem_2110= mem_6666||","||mem_7777
     string mem_2110 = &'00B1' mem_2110                                     #     Добавление знака "+/-" для отчета
     string mem_3 = "Канал 2 диапазон Low"
     # Сравнение и вывод
     math mem_2019 = abs(mem_2011)
     compare mem_2109 mem_2019<=mem_2010 description="ОТКЛОНЕНИЕ НЕ В ДОПУСКЕ!"      #     Определение нахождения значения в дропуске
# в отчет                     Номер канала;     Поверяемая точка, В;     Измеренное значение, В;     Отклонение, В;          Допуск, В;          Вывод о соответствии;
report VDC_MANY_CH           mem_3          mem_2100                    mem_2101                         mem_2011               mem_2110          mem_2109
EndFunction

############ Определение основной погрешности измерения выходного напряжения постоянного тока #########################################################################
#F/Результат ;          Диапазон;        Ток СИ от Imax, А;    Напряжение СИ от U_max, В;        Ток нагрузки от Imax, А;     Интервал жидания, с;
Function VDC_izm_L_CH2     mem_3          mem_2001                         mem_3001                         mem_3999                         mem_69
# Установка выходного напряжения источника     
     math mem_2001 = mem_2001 * U2_max                                              #     Поверяемая точка
     If Interface = true
          DriverSet Model_SI_Driver VDC = mem_2001                                                                                                        # для удаленно управляемого источника
     else
          Message mem_2001 checksyntax  defvalue=mem_2001 "Установите на источнике выходное напряжение равным mem_2001, В \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
# Считывание значения напряжения в точке     
     message wait=mem_69 "Ожидайте выполнения измерения"
     Driverget VOLTAGE_METER mem_2101 = READ                                        #     Запрос текущего значения вольтметра
               If Interface = true
          DriverGet Model_SI_Driver mem_2102= VDC                                                                            # для удаленно управляемого источника
     else
Message mem_2102 checksyntax  defvalue=0 "Укажите значение напряжения измеренное внутренним измерителем источника"          # для источника без интерфейса     
     endif
# Расчет допустимой погрешности и отклонения
     math mem_2010 = VDCch2_izm_coe * mem_2001 + VDCch2_izm_con                              #     Допустимое отклонение для точки
     math mem_2011=mem_2101-mem_2102                                              #     Вычисления модуля отклонения между точками
     math mem_2110 = mem_2010 * 1000                                        #     Перевод в миливольты
     string mem_2110 = &'00B1' mem_2110                                     #     Добавление знака "+/-" для отчета
# Сравнение и вывод
     math mem_2019 = abs(mem_2011)
     compare mem_2109 mem_2019<=mem_2010 description="ОТКЛОНЕНИЕ НЕ В ДОПУСКЕ!"      #     Определение нахождения значения в дропуске
# в отчет                          Поверяемая точка, В;     Измеренное значение, В;          Отклонение, В;          Допуск, В;          Вывод о соответствии;
report VDC_izm                    mem_2001                    mem_2101                         mem_2011          mem_2110          mem_2109
EndFunction

############ Определение нестабильности выходного напряжения при изменении напряжения питающей сети. ###################################################################
#F/Результат ;               Диапазон;     Напряжение СИ от U_max, В;     Ток СИ от Imax, А;          Ток нагрузки от Imax, А;          Интервал жидания, с;     Напряжение питания от U_pit, В;                    
Function INSTB_U_Upit_L_CH2     mem_3          mem_2001                         mem_3001                         mem_3999                         mem_69                              mem_2140                                      
# Установка входного напряжения источника
     DriverSet POWER_SUPPLY V = U_pit
# Установка выходного напряжения источника     
     math mem_2100 = mem_2001 * U2_max                                              #     Выходное напряжение источника
     If Interface = true
          DriverSet Model_SI_Driver VDC = mem_2100                                                                                                             # для удаленно управляемого источника
     else
          Message mem_2100 checksyntax  defvalue=mem_2100 "Установите на источнике выходное напряжение равное mem_2100, В \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
# Установка выходного напряжения источника     
     math mem_3100 = mem_3001 * I2_max                                              #     Поверяемая точка
     If Interface = true
          DriverSet Model_SI_Driver IDC = mem_3100                                                                                                        # для удаленно управляемого источника
     else
          Message mem_3100 checksyntax  defvalue=mem_3100 "Установите на источнике выходной ток равным mem_3100, В \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
     DriverSet LOAD_MODEL Load = On                                                  #     Включение нагрузки
# Плавная подстройка напряжения входного питания (-10%)
     math mem_2140=0,9
     call NASTROIKA_PITANIA
     message wait=mem_69 "Ожидайте выполнения измерения"
     Driverget  VOLTAGE_METER mem_2101 = READ                                   #     Считать показания мультиметра

# Плавная подстройка напряжения входного питания (+10%)
     math mem_2140=1,1
     call NASTROIKA_PITANIA     
     message wait=mem_69 "Ожидайте выполнения измерения"
     Driverget  VOLTAGE_METER mem_2102 = READ                                   #     Считать показания мультиметра
     DriverSet LOAD_MODEL Load = Off                                                  #     Выключение нагрузки
# Расчет допустимой погрешности и отклонения
     math mem_2010 = VDCpit_coe * mem_2100 + VDCpit_con                         #     Допустимое отклонение для точки
     math mem_2110 = mem_2010 * 1000                                      #     Перевод в миливольты
     string mem_2110 = &'00B1' mem_2110                                     #     Добавление знака "+/-" для отчета
     math mem_2011 = abs(mem_2101-mem_2102)                                              #     Вычисления модуля отклонения между точками
     string mem_3 = "Канал 2 диапазон Low"
     # Сравнение и вывод
     compare mem_2109 mem_2011<=mem_2010 description="ОТКЛОНЕНИЕ НЕ В ДОПУСКЕ!"      #     Определение нахождения значения в дропуске
# в отчет                          Номер канала;     Напряжение питания, В;     Поверяемая точка, В;     Измерение 1, В;     Измерение 2, В;     Нестабильность, В;     Допуск, В;          Вывод о соответствии;
report INSTB_U_Upit_MANY_CH     mem_3               "198 - 242"                    mem_2100                    mem_2101               mem_2102               mem_2011                    mem_2110          mem_2109
EndFunction

############ Определение нестабильности выходного напряжения при изменении тока нагрузки. ##############################################################################
#F/Результат;                               Диапазон;     Напряжение СИ от U_max, В;     Ток СИ от Imax, А;          Ток нагрузки от Imax, А;          Интервал жидания, с;     Выходной ток от I_max 2, В;                    
Function INSTB_U_Inagr_L_CH2    					 mem_3          mem_2001                       			  mem_3001                         mem_3999                         mem_69                              mem_3997
# Установка тока нагрузки     
          math mem_3998 = mem_3999 * I2_max
          call TOK_NAGRUZKI
# Установка выходного напряжения источника     
     math mem_2100 = mem_2001 * U2_max                                             #     Поверяемая точка
     If Interface = true
          DriverSet Model_SI_Driver VDC = mem_2100                                                                                                            # для удаленно управляемого источника
          else
          Message mem_2100 checksyntax  defvalue=mem_2100 "Установите на источнике выходное напряжение равное mem_2100, В \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
# Считывание значения напряжения в точке с нагрузкой     
     DriverSet LOAD_MODEL Load = On                                                  #     Включение нагрузки
     message wait=mem_69 "Ожидайте выполнения измерения"
     Driverget  VOLTAGE_METER mem_2101 = READ                                   #     Считать показания мультиметра с нагрузкой
               if mem_3999 != mem_3997     
               # Считывание значения напряжения в точке без нагрузки     
                    math mem_3998 = mem_3997 * I2_max
                    call TOK_NAGRUZKI                                                  #     Установка тока нагрузки               
                    message wait=mem_69 "Ожидайте выполнения измерения"
                    Driverget  VOLTAGE_METER mem_2102 = READ                    #     Считать показания мультиметра без нагрузки
                    math mem_2011 = mem_2102-mem_2101                               #     Вычисления отклонения между точками
                    math mem_2019 = abs(mem_2011)                                   #     Вычисления модуля отклонения
               Else
                    math mem_2011 = mem_2101-mem_2100                              #     Вычисления отклонения между точками
                    math mem_2019 = abs(mem_2011)                                   #     Вычисления модуля отклонения
                    string mem_2102 = "не измерялось в соотв. с методикой"
               Endif
# Расчет допустимой погрешности и отклонения
     math mem_3990 = mem_3999 * I2_max
     math mem_2010 = VDCnagr_coe * mem_2100 + VDCnagr_con                    #     Допустимое отклонение для точки
     math mem_2110 = mem_2010 * 1000                                      #     Перевод в миливольты
     string mem_6666=GetField(mem_2110;".";1)
     string mem_7777=GetField(mem_2110;".";2)
          if mem_7777 = Nan
          math mem_7777 = 0
          endif
     string mem_2110= mem_6666||","||mem_7777
     string mem_2110=&'00B1' mem_2110                                       #     Добавление знака "+/-" для отчета
     string mem_3 = "Канал 2 диапазон Low"
     # Сравнение и вывод
     compare mem_2109 mem_2019<=mem_2010 description="ОТКЛОНЕНИЕ НЕ В ДОПУСКЕ!"      #     Определение нахождения значения в дропуске
# в отчет                               Номер канала;     Поверяемая точка, В;     Показание источника с нагрузкой, В; Ток в нагрузке, А;     Показание источника без нагрузки, В;     Расчетная нестабильность;     Допуск;     Вывод о соответствии;
report INSTB_U_Inagr_MANY_CH          mem_3               mem_2100                    mem_2101                              mem_3990                         mem_2102                                             mem_2019                         mem_2110     mem_2109
EndFunction

############ Определение абсолютной погрешности формирования силы выходного тока. ######################################################################################
#F/Результат;               Диапазон;     Ток СИ от Imax, А;     Напряжение СИ от U_max, В;     Ток нагрузки от Imax, А;          Интервал жидания, с;     
Function IDC_L_CH2          mem_3          mem_3001                         mem_2001                         mem_3999                         mem_69                                   
# Установка выходного тока источника     
     math mem_3100 = mem_3001 * I2_max                                              #     Поверяемая точка
     If Interface = true
          DriverSet Model_SI_Driver IDC = mem_3100                                                                               # для удаленно управляемого источника
          else
          Message mem_3100 checksyntax  defvalue=mem_3100 "Установите на источнике выходной ток равным mem_3100, А \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
     # Установка тока нагрузки     
     math mem_3998 = mem_3999 * I2_max                                             #     Значение тока нагрузки в точке
     call TOK_NAGRUZKI
# Считывание значения тока в точке     
     message wait=mem_69 "Ожидайте выполнения измерения"
     Driverget  CURRENT_METER mem_3101 = IDC                                        #      Считать показания мультиметра (ток)
# Расчет допустимой погрешности и отклонения     
     math mem_3010 = IDC_coe * mem_3100 + IDC_con                              #     Допустимое отклонение для точки
     math mem_3110 = mem_3010 * 1000                                         #     Перевод в милиамперы
     string mem_6666=GetField(mem_3110;".";1)
     string mem_7777=GetField(mem_3110;".";2)
          if mem_7777 = Nan
          math mem_7777 = 0
          endif
     string mem_3110= mem_6666||","||mem_7777
     string mem_3110 = &'00B1' mem_3110                                      #     Добавление знака "+/-" для отчета
     math mem_3011 = mem_3101-mem_3100                                              #     Вычисления модуля отклонения для точки
     string mem_3 = "Канал 2 диапазон Low"
     # Сравнение и вывод
     math mem_3019 = abs(mem_3011)
     compare mem_3109 mem_3019<=mem_3010 description="ОТКЛОНЕНИЕ НЕ В ДОПУСКЕ!"     #      Определение нахождения значения в дропуске
# в отчет                     Номер канала;     Поверяемая точка, А;     Показание источника, А;          Погрешность;     Допуск;          Вывод о соответствии;
report IDC_MANY_CH      mem_3                    mem_3100                    mem_3101                         mem_3011          mem_3110          mem_3109     
EndFunction

############ Определение абсолютной погрешности формирования силы выходного тока. ######################################################################################
#F/Результат;               Диапазон;         Напряжение СИ от U_max, В; Ток СИ от Imax, А;     Ток нагрузки от Imax, А;          Интервал жидания, с;     
Function IDC_izm_L_CH2     mem_3          mem_3001                         mem_2001                         mem_3999                         mem_69                                   
# Установка выходного тока источника     
     math mem_3100 = mem_3001 * I2_max                                             #     Поверяемая точка
     If Interface = true
          DriverSet Model_SI_Driver IDC = mem_3100                                                                               # для удаленно управляемого источника
     else
          Message mem_3100 checksyntax  defvalue=mem_3100 "Установите на источнике выходной ток равный mem_3100 ,А \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
# Считывание значения тока в точке     
     message wait=mem_69 "Ожидайте выполнения измерения"
     Driverget  CURRENT_METER mem_3101 = IDC                                        #      Считать показания мультиметра (ток)
          If Interface = true
          DriverGet Model_SI_Driver mem_3102 = IDC                                                                            # для удаленно управляемого источника
     else
Message mem_3102 checksyntax  defvalue=0 "Укажите значение тока измеренное внутренним измерителем источника"          # для источника без интерфейса     
     endif
# Расчет допустимой погрешности и отклонения     
     math mem_3010 = IDCch2_izm_coe * mem_3100 + IDCch2_izm_con                              #     Допустимое отклонение для точки
     math mem_3110 = mem_3010 * 1000                                         #     Перевод в милиамперы
     string mem_3110 = &'00B1' mem_3110                                      #     Добавление знака "+/-" для отчета
     math mem_3011 = mem_3101-mem_3102                                              #     Вычисления модуля отклонения для точки
# Сравнение и вывод
     math mem_3019 = abs(mem_3011)
     compare mem_3109 mem_3019<=mem_3010 description="ОТКЛОНЕНИЕ НЕ В ДОПУСКЕ!"     #      Определение нахождения значения в дропуске
# в отчет                          Поверяемая точка, А;     Показание источника, А;          Погрешность;     Допуск;          Вывод о соответствии;
report IDC_izm                    mem_3100                    mem_3101                         mem_3011          mem_3110          mem_3109
EndFunction

############ Определение нестабильности выходного тока при изменении напряжения питающей сети. ######################################################################### 
#F/Результат;               Диапазон;     Ток СИ от Imax, А;     Напряжение СИ от U_max, В;      Ток нагрузки от Imax, А;          Интервал жидания, с;     Напряжение питания от U_pit, В;          
Function INSTB_I_Upit_L_CH2     mem_3           mem_3001                    mem_2001                         mem_3999                         mem_69                              mem_2140                                    
# Установка входного напряжения источника
     DriverSet POWER_SUPPLY V = U_pit
# Установка выходного напряжения источника     
     DriverSet LOAD_MODEL Load = Off
     math mem_2100 = mem_2001 * U2_max
     If Interface = true
          DriverSet Model_SI_Driver VDC = mem_2100                                                                                                            # для удаленно управляемого источника
          else
          Message mem_2100 checksyntax  defvalue=mem_2100 "Установите на источнике выходное напряжение равное mem_2100, В \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
# Установка выходного тока источника     
     math mem_3100 = mem_3001 * I2_max                                              
     If Interface = true
          DriverSet Model_SI_Driver IDC = mem_3100                                                                               # для удаленно управляемого источника
          else
          Message mem_3100 checksyntax  defvalue=mem_3100 "Установите на источнике выходной ток равным mem_3100, А \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
     # Установка тока нагрузки     
     math mem_3998 = mem_3999 * I2_max
     call TOK_NAGRUZKI
     DriverSet LOAD_MODEL Load = On                                                  #     Включение нагрузки
# Плавная подстройка напряжения входного питания (-10%)
     math mem_2140=0,9
     call NASTROIKA_PITANIA
     message wait=mem_69 "Ожидайте выполнения измерения"
     Driverget  CURRENT_METER mem_3101 = IDC                                        #      Считать показания мультиметра (ток)

# Плавная подстройка напряжения входного питания (+10%)
     math mem_2140=1,1
     call NASTROIKA_PITANIA
     message wait=mem_69 "Ожидайте выполнения измерения"     
     Driverget  CURRENT_METER mem_3102 = IDC                                        #      Считать показания мультиметра (ток)
# Расчет допустимой погрешности и отклонения     
     math mem_3010 = IDCpit_coe * mem_3100 + IDCpit_con                         #     Допустимое отклонение для точки
     math mem_3110 = mem_3010 * 1000                                      #     Перевод в милиамперы
     string mem_3110 = &'00B1' mem_3110                                      #     Добавление знака "+/-" для отчета
     math mem_3011 = abs(mem_3102-mem_3101)                                              #     Вычисления модуля отклонения между точками
     string mem_3 = "Канал 2 диапазон Low"
     # Сравнение и вывод
     compare mem_3109 mem_3011<=mem_3010 description="ОТКЛОНЕНИЕ НЕ В ДОПУСКЕ!"     #      Определение нахождения значения в дропуске
# в отчет                               Номер канала;     Напряжение питания, В;     Поверяемая точка, А;     Измерение 1, В;     Измерение 2, В;     Нестабильность;     Допуск;     Вывод о соответствии;
report INSTB_I_Upit_MANY_CH          mem_3               "198 - 242"                         mem_3100               mem_3101               mem_3102               mem_3011          mem_3110               mem_3109
EndFunction

############ Определение нестабильности выходного тока при изменении выходного напряжения. #############################################################################
#F/Результат;               Диапазон;     Ток СИ от Imax, А;     Напряжение СИ от U_max, В;     Ток нагрузки от Imax, А;          Интервал жидания, с;     Выходное напряжение от U_max 2, В;
Function INSTB_I_Unagr_L_CH2     mem_3          mem_3001                    mem_2001                            mem_3999                         mem_69                              mem_2003                                 
     # Установка выходного напряжения источника     
     DriverSet LOAD_MODEL Load = Off
     math mem_2100 = mem_2001 * U2_max
     If Interface = true
          DriverSet Model_SI_Driver VDC = mem_2100                                                                                                            # для удаленно управляемого источника
          else
          Message mem_2100 checksyntax  defvalue=mem_2100 "Установите на источнике выходное напряжение равное mem_2100, В \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
     # Установка выходного тока источника     
     math mem_3100 = mem_3001 * I2_max                                             
     If Interface = true
          DriverSet Model_SI_Driver IDC = mem_3100                                                                               # для удаленно управляемого источника
          else
          Message mem_3100 checksyntax  defvalue=mem_3100 "Установите на источнике выходной ток равным mem_3100, А \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
     endif
     
     # Установка тока нагрузки     
     DriverSet LOAD_MODEL Load = On                                                  #     Включение нагрузки
     math mem_3998 = mem_3999 * I2_max
     call TOK_NAGRUZKI
     # Считывание значения тока в точке с нагрузкой
     DriverSet LOAD_MODEL Load = On
     message wait=mem_69 "Ожидайте выполнения измерения"
     Driverget  CURRENT_METER mem_3101 = IDC                                        #     Считать показания мультиметра с нагрузкой (ток)
          DriverSet LOAD_MODEL Load = Off
          if mem_2001 != mem_2003
          # Определение значения напряжения в нагрузке     
          math mem_2002 = U2_max * mem_2003                                             #     Расчет значения напряжения в поверяемой точке
               If Interface = true
                    DriverSet Model_SI_Driver VDC = mem_2002                                                                                                            # для удаленно управляемого источника
               else
                    Message mem_2002 checksyntax  defvalue=mem_2002 "Установите на источнике выходное напряжение равное mem_2002 ,В \n если это не удается, введите наиболее близкое значение, которое можете установить"          # для источника без интерфейса
               endif
          # Считывание значения тока в точке без нагрузки     
          DriverSet LOAD_MODEL Load = On
          message wait=mem_69 "Ожидайте выполнения измерения"
          Driverget  CURRENT_METER mem_3102 = IDC                                        #     Считать показания мультиметра без нагрузки (ток)
          math mem_3011 = mem_3101-mem_3102                                         #     Вычисления модуля отклонения между точками
          math mem_3019 = abs(mem_3011)
          else
          math mem_3011 = mem_3101-mem_3100                                         #     Вычисления модуля отклонения между точками
          math mem_3019 = abs(mem_3011)                                             #     Вычисления модуля отклонения между точками
          string mem_3102 = "не измерялось в соотв. с методикой"
          endif
# Расчет допустимой погрешности и отклонения     
     math mem_3010 = IDCnagr_coe * mem_3100 + IDCnagr_con                    #     Допустимое отклонение для точки
     math mem_3110 = mem_3010 * 1000                                         #     Перевод в милиамперы
     string mem_6666=GetField(mem_3110;".";1)
     string mem_7777=GetField(mem_3110;".";2)
          if mem_7777 = Nan
          math mem_7777 = 0
          endif
     string mem_3110= mem_6666||","||mem_7777
     string mem_3110 = &'00B1' mem_3110                                     #     Добавление знака "+/-" для отчета
     string mem_3 = "Канал 2 диапазон Low"
     # Сравнение и вывод
     compare mem_3109 mem_3019<=mem_3010 description="ОТКЛОНЕНИЕ НЕ В ДОПУСКЕ!"     #      Определение нахождения значения в дропуске
# в отчет                               Номер канала;     Значение тока в точке, А;     Показание источника с нагрузкой, А;     Напряжение в нагрузке, В;     Показание источника без нагрузки, А;     Нестабильность, А;     Допуск, А;     Вывод о соответствии;
report INSTB_I_Unagr_MANY_CH         mem_3      mem_3100           mem_3101                     mem_2100                mem_3102                          mem_3011       mem_3110   mem_3109 
EndFunction

############ Функция плавной подстройки питания     ########################################################################################################################
Function NASTROIKA_PITANIA                         
     math mem_2141 = U_pit * mem_2140                                        
     math mem_2 = U_pit                                                            
          if mem_2 > mem_2141
               repeat mem_2
               if mem_2 = mem_2141
               stoprepeat
               endif
               delay 100
               math mem_2 = mem_2 - 1
               DriverSet POWER_SUPPLY V = mem_2
               endrepeat
          else
               repeat mem_2
               if mem_2 = mem_2141
               stoprepeat
               endif
               delay 100
               math mem_2 = mem_2 + 1
               DriverSet POWER_SUPPLY V = mem_2
               endrepeat
          endif     
EndFunction

############ Функция сброса всех приборов ##############################################################################################################################
Function RESET_ALL

DriverSet     LOAD_MODEL                RESET
     if "interface" = "true"
          DriverSet     Model_SI_Driver          RESET
     endif
DriverSet     Keithley7001           RESET
DriverSet     VOLTAGE_METER           RESET
DriverSet     CURRENT_METER           RESET
DriverSet     POWER_SUPPLY           V = 220

EndFunction

############ Проверка для нагрузки (нужно учитывать и ток, и напряжение, и мощность) ###################################################################################
Function TOK_NAGRUZKI
          if mem_3998 <= Load_Max_Curr                                         # Сравнение устанавливаемого значения тока с максимальным током Нагрузки
               math mem_1 = mem_3998*U_max
               if mem_1<=Load_Max_Power
                    DriverSet LOAD_MODEL I_H = mem_3998
               else
                    math mem_3998=Load_Max_Power/U_max
                    DriverSet LOAD_MODEL I_H = mem_3998
               endif
          else 
               math mem_1 = I_max*U_max
               if mem_1<=Load_Max_Power
                    DriverSet LOAD_MODEL I_H = Load_Max_Curr               # Если устанавливаемое значение больше максиманого тока Нагрузки - установить максимаотный ток нагрузки.
               else
                    math mem_3998=Load_Max_Power/U_max
                    DriverSet LOAD_MODEL I_H = mem_3998
               endif
          endif
EndFunction

#########################################################################################################################################################################
#######   I   N   T   E   R   R   U   P   T   ##########################################################################################################################
#########################################################################################################################################################################

#################### Канал 1     ##############################################################################

#########################################################################################################################################################################
#############          Начальные установки для определения основной погрешности установки выходного напряжения постоянного тока          #####################################

Interrupt before VDC_H  first_in_script
     If Interface = true
     IF CHANEL_NOM = 2
	 DriverSet Model_SI_Driver channel = 1
	 Endif
     DriverSet Model_SI_Driver RANGE = HIGH
	 message "Подключите канал 1 поверяемого источника питания и уcтановите диапазон High для выполнения процедуры поверки в автоматическом режиме"
     else
message "Подключите канал 1 поверяемого источника питания и уcтановите диапазон High для выполнения процедуры поверки в автоматическом режиме"
 Endif
     # Установить на источнике переменного напряжения значение стандартного напряжения питания (на случай ранее проведенных изменений)
          DriverSet POWER_SUPPLY V = U_pit
     # Перевод вольтметра в режим VDC
          DriverSet VOLTAGE_METER RESET
          DriverSet VOLTAGE_METER Func = VDC
     # Установка тока нагрузки
          if mem_3999 = 0
               DriverSet     LOAD_MODEL Load = Off
               math mem_3998 = mem_3999
          Else
               DriverSet     LOAD_MODEL Load = On                                             #     Включение нагрузки
               math mem_3998 = mem_3999 * I_max
               call TOK_NAGRUZKI
          Endif
     # Установка выходного тока источника     
          math mem_3100 = mem_3001 * I_max
          If Interface = true
#               DriverSet Model_SI_Driver     Mod = CV
#               DriverSet Model_SI_Driver     RANGE = High
               DriverSet Model_SI_Driver     IDC = mem_3100                                                                                                        # для удаленно управляемого источника
          else
               message "На поверяемом источнике установите режим стабилизации по напряжению (СV) и переключите в диапазон High"          # для источника без интерфейса
               message "На поверяемом источнике установите регулятором выходного тока установите максимальное значение для диапазона High"          # для источника без интерфейса
          endif
EndInterrupt

#########################################################################################################################################################################
#############          Начальные установки для определения основной погрешности измерения выходного напряжения постоянного тока          #####################################

Interrupt before VDC_izm_H  first_in_script
      If Interface = true
     IF CHANEL_NOM = 2
	 DriverSet Model_SI_Driver channel = 1
	 Endif
     DriverSet Model_SI_Driver RANGE = HIGH
 Endif
    # Установить на источнике переменного напряжения значение стандартного напряжения питания (на случай ранее проведенных изменений)
          DriverSet POWER_SUPPLY V = U_pit
     # Перевод вольтметра в режим VDC
          DriverSet VOLTAGE_METER RESET
          DriverSet VOLTAGE_METER Func = VDC          
          # Установка тока нагрузки     
          if mem_3999 = 0
               DriverSet     LOAD_MODEL Load = Off
               math mem_3998 = mem_3999
          Else
               DriverSet     LOAD_MODEL Load = On                                             #     Включение нагрузки
               math mem_3998 = mem_3999 * I_max
               call TOK_NAGRUZKI
          Endif
     # Установка выходного напряжения источника     
          math mem_2100 = mem_2001 * U_max
          If Interface = true
#               DriverSet Model_SI_Driver     Mod = CC
                DriverSet Model_SI_Driver     VDC = mem_2100                                                                                                       # для удаленно управляемого источника
          else
               message "На поверяемом источнике установите режим стабилизации по току (СC)"          # для источника без интерфейса
               message "На поверяемом источнике установите максимальное значение напряжения для диапазона High "          # для источника без интерфейса
          endif
EndInterrupt

#########################################################################################################################################################################
#############          Начальные установки для определения основной нестабильности выходного напряжения при изменении напряжения питания          #################################

Interrupt before INSTB_U_Upit_H first_in_script
       If Interface = true
     IF CHANEL_NOM = 2
	 DriverSet Model_SI_Driver channel = 1
	 Endif
     DriverSet Model_SI_Driver RANGE = HIGH
 Endif
    #Перевод вольтметра в режим VDC
          DriverSet VOLTAGE_METER RESET
          DriverSet VOLTAGE_METER Func = VDC
     #Установка тока нагрузки     
          DriverSet LOAD_MODEL Load = On                                                  #     Включение нагрузки
          math mem_3998 = mem_3999 * I_max
          call TOK_NAGRUZKI
EndInterrupt

#########################################################################################################################################################################
#############          Начальные установки для определения основной нестабильности выходного напряжения при изменении тока нагрузки          #################################

Interrupt before INSTB_U_Inagr_H first_in_script
       If Interface = true
     IF CHANEL_NOM = 2
	 DriverSet Model_SI_Driver channel = 1
	 Endif
     DriverSet Model_SI_Driver RANGE = HIGH
 Endif
    # Установить на источнике переменного напряжения значение стандартного напряжения питания (на случай ранее проведенных изменений)
          DriverSet POWER_SUPPLY V = U_pit
     #Перевод вольтметра в режим VDC
          DriverSet VOLTAGE_METER RESET
          DriverSet VOLTAGE_METER Func = VDC
EndInterrupt

#########################################################################################################################################################################
####################################          Начальные установки для определения основной погрешности установки выходного тока ########################################################

Interrupt before IDC_H first_in_script
        If Interface = true
     IF CHANEL_NOM = 2
	 DriverSet Model_SI_Driver channel = 1
	 Endif
     DriverSet Model_SI_Driver RANGE = HIGH
 Endif
   # Перевод нагрузки в режим СC
          DriverSet LOAD_MODEL MODE = CC
     # Установить на источнике переменного напряжения значение стандартного напряжения питания (на случай ранее проведенных изменений)
          DriverSet POWER_SUPPLY V = U_pit
     # Установка диапазона для амперметра
          If I_max <= 30
               DriverSet CURRENT_METER Range_IDC = 30                                   #     установка предела измерений амперметра 30А
          Else
               DriverSet CURRENT_METER Range_IDC = 300                                   #     установка предела измерений амперметра 300А
          Endif
     # Установка выходного напряжения источника     
          DriverSet LOAD_MODEL Load = Off
          math mem_2100 = mem_2001 * U_max
          If Interface = true
               DriverSet Model_SI_Driver VDC = mem_2100                                                                                                            # для удаленно управляемого источника
          else
               message "На поверяемом источнике установите режим стабилизации по току (СC) и переключите в диапазон High"          # для источника без интерфейса
               message "На поверяемом источнике установите максимальное значение выходного напряжения для диапазона High"          # для источника без интерфейса
          endif
     # Установка тока нагрузки     
          DriverSet LOAD_MODEL Load = On                                                  #     Включение нагрузки
          math mem_3998 = mem_3999 * I_max
          call TOK_NAGRUZKI
EndInterrupt

#########################################################################################################################################################################
#############          Начальные установки для определения основной погрешности измерения выходного тока          #################################################################

Interrupt before IDC_izm_H  first_in_script
        If Interface = true
     IF CHANEL_NOM = 2
	 DriverSet Model_SI_Driver channel = 1
	 Endif
     DriverSet Model_SI_Driver RANGE = HIGH
 Endif
   # Перевод нагрузки в режим СC
          DriverSet LOAD_MODEL MODE = CC
     # Установить на источнике переменного напряжения значение стандартного напряжения питания (на случай ранее проведенных изменений)
          DriverSet POWER_SUPPLY V = U_pit
     # Установка диапазона для амперметра
          If I_max <= 30
               DriverSet CURRENT_METER Range_IDC = 30                                   #     установка предела измерений амперметра 30А
          Else
               DriverSet CURRENT_METER Range_IDC = 300                                   #     установка предела измерений амперметра 300А
          Endif
     # Установка выходного напряжения источника     
          DriverSet LOAD_MODEL Load = Off
          math mem_3100 = mem_3001 * I_max
          If Interface = true
               DriverSet Model_SI_Driver     IDC = mem_3100    
          else
               message "На поверяемом источнике установите режим стабилизации по напряжению (СV) и переключите в диапазон High"          # для источника без интерфейса
               message "На поверяемом источнике установите максимальное значение выходного тока и напряжения для диапазона High "          # для источника без интерфейса
          endif
     # Установка тока нагрузки     
          DriverSet LOAD_MODEL Load = On                                                  #     Включение нагрузки
          math mem_3998 = mem_3999 * I_max
          call TOK_NAGRUZKI
EndInterrupt

#########################################################################################################################################################################
#############          Начальные установки для определения основной нестабильности выходного тока при изменении напряжения питания          #################################

Interrupt before INSTB_I_Upit_H first_in_script
       If Interface = true
     IF CHANEL_NOM = 2
	 DriverSet Model_SI_Driver channel = 1
	 Endif
     DriverSet Model_SI_Driver RANGE = HIGH
 Endif
    # Перевод нагрузки в режим СC
          DriverSet LOAD_MODEL MODE = CC
     # Установить на источнике переменного напряжения значение стандартного напряжения питания (на случай ранее проведенных изменений)
          DriverSet POWER_SUPPLY V = U_pit
     # Установка диапазона для амперметра
          If I_max <= 30
               DriverSet CURRENT_METER Range_IDC = 30                                   #     установка предела измерений амперметра 30А
          Else
               DriverSet CURRENT_METER Range_IDC = 300                                   #     установка предела измерений амперметра 300А
          Endif
EndInterrupt

#########################################################################################################################################################################
#############          Начальные установки для определения основной нестабильности выходного тока при изменении напряжения нагрузки          #################################

Interrupt before INSTB_I_Unagr_H first_in_script
        If Interface = true
     IF CHANEL_NOM = 2
	 DriverSet Model_SI_Driver channel = 1
	 Endif
     DriverSet Model_SI_Driver RANGE = HIGH
 Endif
   # Перевод нагрузки в режим СC
          DriverSet LOAD_MODEL MODE = CC
     # Установить на источнике переменного напряжения значение стандартного напряжения питания (на случай ранее проведенных изменений)
          DriverSet POWER_SUPPLY V = U_pit
     # Установка диапазона для амперметра
          If I_max <= 30
               DriverSet CURRENT_METER Range_IDC = 30                                   #     установка предела измерений амперметра 30А
          Else
               DriverSet CURRENT_METER Range_IDC = 300                                   #     установка предела измерений амперметра 300А
          Endif
EndInterrupt


######################### Low ####################################

#########################################################################################################################################################################
#############          Начальные установки для определения основной погрешности установки выходного напряжения постоянного тока          #####################################

Interrupt before VDC_L  first_in_script
     If Interface = true
     IF CHANEL_NOM = 2
	 DriverSet Model_SI_Driver channel = 1
	 Endif
     DriverSet Model_SI_Driver RANGE = LOW
     else
               message "Подключите канал 1 поверяемого источника питания и уcтановите диапазон Low для выполнения процедуры поверки в автоматическом режиме"
 Endif
     # Установить на источнике переменного напряжения значение стандартного напряжения питания (на случай ранее проведенных изменений)
          DriverSet POWER_SUPPLY V = U_pit
     # Перевод вольтметра в режим VDC
          DriverSet VOLTAGE_METER RESET
          DriverSet VOLTAGE_METER Func = VDC
     # Установка тока нагрузки
          if mem_3999 = 0
               DriverSet     LOAD_MODEL Load = Off
               math mem_3998 = mem_3999
          Else
               DriverSet     LOAD_MODEL Load = On                                             #     Включение нагрузки
               math mem_3998 = mem_3999 * I2_max
               call TOK_NAGRUZKI
          Endif
     # Установка выходного тока источника     
          math mem_3100 = mem_3001 * I2_max
          If Interface = true
               DriverSet Model_SI_Driver     IDC = mem_3100                                                                                                        # для удаленно управляемого источника
          else
               message "На поверяемом источнике установите режим стабилизации по напряжению (СV) и переключите в диапазон Low"          # для источника без интерфейса
               message "На поверяемом источнике установите регулятором выходного тока установите максимальное значение для диапазона Low"          # для источника без интерфейса
          endif
EndInterrupt

#########################################################################################################################################################################
#############          Начальные установки для определения основной погрешности измерения выходного напряжения постоянного тока          #####################################

Interrupt before VDC_izm_L  first_in_script
     If Interface = true
     IF CHANEL_NOM = 2
	 DriverSet Model_SI_Driver channel = 1
	 Endif
     DriverSet Model_SI_Driver RANGE = LOW
 Endif
     # Установить на источнике переменного напряжения значение стандартного напряжения питания (на случай ранее проведенных изменений)
          DriverSet POWER_SUPPLY V = U_pit
     # Перевод вольтметра в режим VDC
          DriverSet VOLTAGE_METER RESET
          DriverSet VOLTAGE_METER Func = VDC          
          # Установка тока нагрузки     
          if mem_3999 = 0
               DriverSet     LOAD_MODEL Load = Off
               math mem_3998 = mem_3999
          Else
               DriverSet     LOAD_MODEL Load = On                                             #     Включение нагрузки
               math mem_3998 = mem_3999 * I2_max
               call TOK_NAGRUZKI
          Endif
     # Установка выходного напряжения источника     
          math mem_2100 = mem_2001 * U2_max
          If Interface = true
                DriverSet Model_SI_Driver     VDC = mem_2100                                                                                                       # для удаленно управляемого источника
          else
               message "На поверяемом источнике установите режим стабилизации по току (СC) и переключите в диапазон Low"          # для источника без интерфейса
               message "На поверяемом источнике установите максимальное значение напряжения для диапазона Low "          # для источника без интерфейса
          endif
EndInterrupt

#########################################################################################################################################################################
#############          Начальные установки для определения основной нестабильности выходного напряжения при изменении напряжения питания          #################################

Interrupt before INSTB_U_Upit_L first_in_script
     If Interface = true
     IF CHANEL_NOM = 2
	 DriverSet Model_SI_Driver channel = 1
	 Endif
     DriverSet Model_SI_Driver RANGE = LOW
 Endif
     #Перевод вольтметра в режим VDC
          DriverSet VOLTAGE_METER RESET
          DriverSet VOLTAGE_METER Func = VDC
          DriverSet LOAD_MODEL Load = On                                                  #     Включение нагрузки
          math mem_3998 = mem_3999 * I2_max
          call TOK_NAGRUZKI
EndInterrupt

#########################################################################################################################################################################
#############          Начальные установки для определения основной нестабильности выходного напряжения при изменении тока нагрузки          #################################

Interrupt before INSTB_U_Inagr_L first_in_script
       If Interface = true
     IF CHANEL_NOM = 2
	 DriverSet Model_SI_Driver channel = 1
	 Endif
     DriverSet Model_SI_Driver RANGE = LOW
 Endif
   # Установить на источнике переменного напряжения значение стандартного напряжения питания (на случай ранее проведенных изменений)
          DriverSet POWER_SUPPLY V = U_pit
     #Перевод вольтметра в режим VDC
          DriverSet VOLTAGE_METER RESET
          DriverSet VOLTAGE_METER Func = VDC
EndInterrupt

#########################################################################################################################################################################
####################################          Начальные установки для определения основной погрешности установки выходного тока ########################################################

Interrupt before IDC_L first_in_script
      If Interface = true
     IF CHANEL_NOM = 2
	 DriverSet Model_SI_Driver channel = 1
	 Endif
     DriverSet Model_SI_Driver RANGE = LOW
 Endif
    # Перевод нагрузки в режим СC
          DriverSet LOAD_MODEL MODE = CC
     # Установить на источнике переменного напряжения значение стандартного напряжения питания (на случай ранее проведенных изменений)
          DriverSet POWER_SUPPLY V = U_pit
     # Установка диапазона для амперметра
          If I_max <= 30
               DriverSet CURRENT_METER Range_IDC = 30                                   #     установка предела измерений амперметра 30А
          Else
               DriverSet CURRENT_METER Range_IDC = 300                                   #     установка предела измерений амперметра 300А
          Endif
     # Установка выходного напряжения источника     
          DriverSet LOAD_MODEL Load = Off
          math mem_2100 = mem_2001 * U2_max
          If Interface = true
               DriverSet Model_SI_Driver VDC = mem_2100                                                                                                            # для удаленно управляемого источника
          else
               message "На поверяемом источнике установите режим стабилизации по току (СC) и переключите в диапазон Low"          # для источника без интерфейса
               message "На поверяемом источнике установите максимальное значение выходного напряжения для диапазона Low"          # для источника без интерфейса
          endif
     # Установка тока нагрузки     
          DriverSet LOAD_MODEL Load = On                                                  #     Включение нагрузки
          math mem_3998 = mem_3999 * I2_max
          call TOK_NAGRUZKI
EndInterrupt

#########################################################################################################################################################################
#############          Начальные установки для определения основной погрешности измерения выходного тока          #################################################################

Interrupt before IDC_izm_L  first_in_script
      If Interface = true
     IF CHANEL_NOM = 2
	 DriverSet Model_SI_Driver channel = 1
	 Endif
     DriverSet Model_SI_Driver RANGE = LOW
 Endif
    # Перевод нагрузки в режим СC
          DriverSet LOAD_MODEL MODE = CC
     # Установить на источнике переменного напряжения значение стандартного напряжения питания (на случай ранее проведенных изменений)
          DriverSet POWER_SUPPLY V = U_pit
     # Установка диапазона для амперметра
          If I_max <= 30
               DriverSet CURRENT_METER Range_IDC = 30                                   #     установка предела измерений амперметра 30А
          Else
               DriverSet CURRENT_METER Range_IDC = 300                                   #     установка предела измерений амперметра 300А
          Endif
     # Установка выходного напряжения источника     
          DriverSet LOAD_MODEL Load = Off
          math mem_3100 = mem_3001 * I2_max
          If Interface = true
               DriverSet Model_SI_Driver     IDC = mem_3100    
          else
               message "На поверяемом источнике установите режим стабилизации по напряжению (СV) и переключите в диапазон Low"          # для источника без интерфейса
               message "На поверяемом источнике установите максимальное значение выходного тока и напряжения для диапазона Low "          # для источника без интерфейса
          endif
     # Установка тока нагрузки     
          DriverSet LOAD_MODEL Load = On                                                  #     Включение нагрузки
          math mem_3998 = mem_3999 * I2_max
          call TOK_NAGRUZKI
EndInterrupt

#########################################################################################################################################################################
#############          Начальные установки для определения основной нестабильности выходного тока при изменении напряжения питания          #################################

Interrupt before INSTB_I_Upit_L first_in_script
      If Interface = true
     IF CHANEL_NOM = 2
	 DriverSet Model_SI_Driver channel = 1
	 Endif
     DriverSet Model_SI_Driver RANGE = LOW
 Endif
    # Перевод нагрузки в режим СC
          DriverSet LOAD_MODEL MODE = CC
     # Установить на источнике переменного напряжения значение стандартного напряжения питания (на случай ранее проведенных изменений)
          DriverSet POWER_SUPPLY V = U_pit
     # Установка диапазона для амперметра
          If I_max <= 30
               DriverSet CURRENT_METER Range_IDC = 30                                   #     установка предела измерений амперметра 30А
          Else
               DriverSet CURRENT_METER Range_IDC = 300                                   #     установка предела измерений амперметра 300А
          Endif
EndInterrupt

#########################################################################################################################################################################
#############          Начальные установки для определения основной нестабильности выходного тока при изменении напряжения нагрузки          #################################

Interrupt before INSTB_I_Unagr_L first_in_script
      If Interface = true
     IF CHANEL_NOM = 2
	 DriverSet Model_SI_Driver channel = 1
	 Endif
     DriverSet Model_SI_Driver RANGE = LOW
 Endif
    # Перевод нагрузки в режим СC
          DriverSet LOAD_MODEL MODE = CC
     # Установить на источнике переменного напряжения значение стандартного напряжения питания (на случай ранее проведенных изменений)
          DriverSet POWER_SUPPLY V = U_pit
     # Установка диапазона для амперметра
          If I2_max <= 30
               DriverSet CURRENT_METER Range_IDC = 30                                   #     установка предела измерений амперметра 30А
          Else
               DriverSet CURRENT_METER Range_IDC = 300                                   #     установка предела измерений амперметра 300А
          Endif
EndInterrupt

#########################################################################################################################################################################
#################### Канал 2     ##############################################################################
#########################################################################################################################################################################

#########################################################################################################################################################################
#############          Начальные установки для определения основной погрешности установки выходного напряжения постоянного тока          #####################################

Interrupt before VDC_H_CH2  first_in_script
     If Interface = true
   	 message "Подключите канал 2 поверяемого источника питания и уcтановите диапазон High для выполнения процедуры поверки в автоматическом режиме"
     DriverSet Model_SI_Driver channel = 2
DriverSet Model_SI_Driver RANGE = HIGH
     else
	 	 message "Подключите канал 2 поверяемого источника питания и уcтановите диапазон High для выполнения процедуры поверки в автоматическом режиме"
 Endif
     # Установить на источнике переменного напряжения значение стандартного напряжения питания (на случай ранее проведенных изменений)
          DriverSet POWER_SUPPLY V = U_pit
     # Перевод вольтметра в режим VDC
          DriverSet VOLTAGE_METER RESET
          DriverSet VOLTAGE_METER Func = VDC
     # Установка тока нагрузки
          if mem_3999 = 0
               DriverSet     LOAD_MODEL Load = Off
               math mem_3998 = mem_3999
          Else
               DriverSet     LOAD_MODEL Load = On                                             #     Включение нагрузки
               math mem_3998 = mem_3999 * I_max
               call TOK_NAGRUZKI
          Endif
     # Установка выходного тока источника     
          math mem_3100 = mem_3001 * I_max
          If Interface = true
#               DriverSet Model_SI_Driver     Mod = CV
#               DriverSet Model_SI_Driver     RANGE = High
               DriverSet Model_SI_Driver     IDC = mem_3100                                                                                                        # для удаленно управляемого источника
          else
               message "На поверяемом источнике установите режим стабилизации по напряжению (СV) и переключите в диапазон High"          # для источника без интерфейса
               message "На поверяемом источнике установите регулятором выходного тока установите максимальное значение для диапазона High"          # для источника без интерфейса
          endif
EndInterrupt

#########################################################################################################################################################################
#############          Начальные установки для определения основной погрешности измерения выходного напряжения постоянного тока          #####################################

Interrupt before VDC_izm_H_CH2  first_in_script
     If Interface = true
     DriverSet Model_SI_Driver channel = 2
	DriverSet Model_SI_Driver RANGE = HIGH
 Endif
    # Установить на источнике переменного напряжения значение стандартного напряжения питания (на случай ранее проведенных изменений)
          DriverSet POWER_SUPPLY V = U_pit
     # Перевод вольтметра в режим VDC
          DriverSet VOLTAGE_METER RESET
          DriverSet VOLTAGE_METER Func = VDC          
          # Установка тока нагрузки     
          if mem_3999 = 0
               DriverSet     LOAD_MODEL Load = Off
               math mem_3998 = mem_3999
          Else
               DriverSet     LOAD_MODEL Load = On                                             #     Включение нагрузки
               math mem_3998 = mem_3999 * I_max
               call TOK_NAGRUZKI
          Endif
     # Установка выходного напряжения источника     
          math mem_2100 = mem_2001 * U_max
          If Interface = true
#               DriverSet Model_SI_Driver     Mod = CC
                DriverSet Model_SI_Driver     VDC = mem_2100                                                                                                       # для удаленно управляемого источника
          else
               message "На поверяемом источнике установите режим стабилизации по току (СC)"          # для источника без интерфейса
               message "На поверяемом источнике установите максимальное значение напряжения для диапазона High "          # для источника без интерфейса
          endif
EndInterrupt

#########################################################################################################################################################################
#############          Начальные установки для определения основной нестабильности выходного напряжения при изменении напряжения питания          #################################

Interrupt before INSTB_U_Upit_H_CH2 first_in_script
     #Перевод вольтметра в режим VDC
          DriverSet VOLTAGE_METER RESET
          DriverSet VOLTAGE_METER Func = VDC
     #Установка тока нагрузки     
          DriverSet LOAD_MODEL Load = On                                                  #     Включение нагрузки
          math mem_3998 = mem_3999 * I_max
          call TOK_NAGRUZKI
EndInterrupt

#########################################################################################################################################################################
#############          Начальные установки для определения основной нестабильности выходного напряжения при изменении тока нагрузки          #################################

Interrupt before INSTB_U_Inagr_H_CH2 first_in_script
     # Установить на источнике переменного напряжения значение стандартного напряжения питания (на случай ранее проведенных изменений)
          DriverSet POWER_SUPPLY V = U_pit
     #Перевод вольтметра в режим VDC
          DriverSet VOLTAGE_METER RESET
          DriverSet VOLTAGE_METER Func = VDC
EndInterrupt

#########################################################################################################################################################################
####################################          Начальные установки для определения основной погрешности установки выходного тока ########################################################

Interrupt before IDC_H_CH2 first_in_script
     # Перевод нагрузки в режим СC
          DriverSet LOAD_MODEL MODE = CC
     # Установить на источнике переменного напряжения значение стандартного напряжения питания (на случай ранее проведенных изменений)
          DriverSet POWER_SUPPLY V = U_pit
     # Установка диапазона для амперметра
          If I_max <= 30
               DriverSet CURRENT_METER Range_IDC = 30                                   #     установка предела измерений амперметра 30А
          Else
               DriverSet CURRENT_METER Range_IDC = 300                                   #     установка предела измерений амперметра 300А
          Endif
     # Установка выходного напряжения источника     
          DriverSet LOAD_MODEL Load = Off
          math mem_2100 = mem_2001 * U_max
          If Interface = true
               DriverSet Model_SI_Driver VDC = mem_2100                                                                                                            # для удаленно управляемого источника
          else
               message "На поверяемом источнике установите режим стабилизации по току (СC) и переключите в диапазон High"          # для источника без интерфейса
               message "На поверяемом источнике установите максимальное значение выходного напряжения для диапазона High"          # для источника без интерфейса
          endif
     # Установка тока нагрузки     
          DriverSet LOAD_MODEL Load = On                                                  #     Включение нагрузки
          math mem_3998 = mem_3999 * I_max
          call TOK_NAGRUZKI
EndInterrupt

#########################################################################################################################################################################
#############          Начальные установки для определения основной погрешности измерения выходного тока          #################################################################

Interrupt before IDC_izm_H_CH2  first_in_script
     If Interface = true
     DriverSet Model_SI_Driver channel = 2
	DriverSet Model_SI_Driver RANGE = HIGH
 Endif
    # Перевод нагрузки в режим СC
          DriverSet LOAD_MODEL MODE = CC
     # Установить на источнике переменного напряжения значение стандартного напряжения питания (на случай ранее проведенных изменений)
          DriverSet POWER_SUPPLY V = U_pit
     # Установка диапазона для амперметра
          If I_max <= 30
               DriverSet CURRENT_METER Range_IDC = 30                                   #     установка предела измерений амперметра 30А
          Else
               DriverSet CURRENT_METER Range_IDC = 300                                   #     установка предела измерений амперметра 300А
          Endif
     # Установка выходного напряжения источника     
          DriverSet LOAD_MODEL Load = Off
          math mem_3100 = mem_3001 * I_max
          If Interface = true
               DriverSet Model_SI_Driver     IDC = mem_3100    
          else
               message "На поверяемом источнике установите режим стабилизации по напряжению (СV) и переключите в диапазон High"          # для источника без интерфейса
               message "На поверяемом источнике установите максимальное значение выходного тока и напряжения для диапазона High "          # для источника без интерфейса
          endif
     # Установка тока нагрузки     
          DriverSet LOAD_MODEL Load = On                                                  #     Включение нагрузки
          math mem_3998 = mem_3999 * I_max
          call TOK_NAGRUZKI
EndInterrupt

#########################################################################################################################################################################
#############          Начальные установки для определения основной нестабильности выходного тока при изменении напряжения питания          #################################

Interrupt before INSTB_I_Upit_H_CH2 first_in_script
     # Перевод нагрузки в режим СC
          DriverSet LOAD_MODEL MODE = CC
     # Установить на источнике переменного напряжения значение стандартного напряжения питания (на случай ранее проведенных изменений)
          DriverSet POWER_SUPPLY V = U_pit
     # Установка диапазона для амперметра
          If I_max <= 30
               DriverSet CURRENT_METER Range_IDC = 30                                   #     установка предела измерений амперметра 30А
          Else
               DriverSet CURRENT_METER Range_IDC = 300                                   #     установка предела измерений амперметра 300А
          Endif
EndInterrupt

#########################################################################################################################################################################
#############          Начальные установки для определения основной нестабильности выходного тока при изменении напряжения нагрузки          #################################

Interrupt before INSTB_I_Unagr_H_CH2 first_in_script
     # Перевод нагрузки в режим СC
          DriverSet LOAD_MODEL MODE = CC
     # Установить на источнике переменного напряжения значение стандартного напряжения питания (на случай ранее проведенных изменений)
          DriverSet POWER_SUPPLY V = U_pit
     # Установка диапазона для амперметра
          If I_max <= 30
               DriverSet CURRENT_METER Range_IDC = 30                                   #     установка предела измерений амперметра 30А
          Else
               DriverSet CURRENT_METER Range_IDC = 300                                   #     установка предела измерений амперметра 300А
          Endif
EndInterrupt


######################### Low ####################################

#########################################################################################################################################################################
#############          Начальные установки для определения основной погрешности установки выходного напряжения постоянного тока          #####################################

Interrupt before VDC_L_CH2  first_in_script
     If Interface = true
     DriverSet Model_SI_Driver channel = 2
	DriverSet Model_SI_Driver RANGE = LOW
 Endif
    If Interface = true
               DriverSet Model_SI_Driver RANGE = LOW
     else
               message "Подключите канал 2 поверяемого источника питания и уcтановите диапазон Low для выполнения процедуры поверки в автоматическом режиме"
 Endif
     # Установить на источнике переменного напряжения значение стандартного напряжения питания (на случай ранее проведенных изменений)
          DriverSet POWER_SUPPLY V = U_pit
     # Перевод вольтметра в режим VDC
          DriverSet VOLTAGE_METER RESET
          DriverSet VOLTAGE_METER Func = VDC
     # Установка тока нагрузки
          if mem_3999 = 0
               DriverSet     LOAD_MODEL Load = Off
               math mem_3998 = mem_3999
          Else
               DriverSet     LOAD_MODEL Load = On                                             #     Включение нагрузки
               math mem_3998 = mem_3999 * I2_max
               call TOK_NAGRUZKI
          Endif
     # Установка выходного тока источника     
          math mem_3100 = mem_3001 * I2_max
          If Interface = true
               DriverSet Model_SI_Driver     IDC = mem_3100                                                                                                        # для удаленно управляемого источника
          else
               message "На поверяемом источнике установите режим стабилизации по напряжению (СV) и переключите в диапазон Low"          # для источника без интерфейса
               message "На поверяемом источнике установите регулятором выходного тока установите максимальное значение для диапазона Low"          # для источника без интерфейса
          endif
EndInterrupt

#########################################################################################################################################################################
#############          Начальные установки для определения основной погрешности измерения выходного напряжения постоянного тока          #####################################

Interrupt before VDC_izm_L_CH2  first_in_script
     If Interface = true
     DriverSet Model_SI_Driver channel = 2
	DriverSet Model_SI_Driver RANGE = LOW
 Endif
    # Установить на источнике переменного напряжения значение стандартного напряжения питания (на случай ранее проведенных изменений)
          DriverSet POWER_SUPPLY V = U_pit
     # Перевод вольтметра в режим VDC
          DriverSet VOLTAGE_METER RESET
          DriverSet VOLTAGE_METER Func = VDC          
          # Установка тока нагрузки     
          if mem_3999 = 0
               DriverSet     LOAD_MODEL Load = Off
               math mem_3998 = mem_3999
          Else
               DriverSet     LOAD_MODEL Load = On                                             #     Включение нагрузки
               math mem_3998 = mem_3999 * I2_max
               call TOK_NAGRUZKI
          Endif
     # Установка выходного напряжения источника     
          math mem_2100 = mem_2001 * U2_max
          If Interface = true
                DriverSet Model_SI_Driver     VDC = mem_2100                                                                                                       # для удаленно управляемого источника
          else
               message "На поверяемом источнике установите режим стабилизации по току (СC) и переключите в диапазон Low"          # для источника без интерфейса
               message "На поверяемом источнике установите максимальное значение напряжения для диапазона Low "          # для источника без интерфейса
          endif
EndInterrupt

#########################################################################################################################################################################
#############          Начальные установки для определения основной нестабильности выходного напряжения при изменении напряжения питания          #################################

Interrupt before INSTB_U_Upit_L first_in_script
     #Перевод вольтметра в режим VDC
          DriverSet VOLTAGE_METER RESET
          DriverSet VOLTAGE_METER Func = VDC
          DriverSet LOAD_MODEL Load = On                                                  #     Включение нагрузки
          math mem_3998 = mem_3999 * I2_max
          call TOK_NAGRUZKI
EndInterrupt

#########################################################################################################################################################################
#############          Начальные установки для определения основной нестабильности выходного напряжения при изменении тока нагрузки          #################################

Interrupt before INSTB_U_Inagr_L first_in_script
     # Установить на источнике переменного напряжения значение стандартного напряжения питания (на случай ранее проведенных изменений)
          DriverSet POWER_SUPPLY V = U_pit
     #Перевод вольтметра в режим VDC
          DriverSet VOLTAGE_METER RESET
          DriverSet VOLTAGE_METER Func = VDC
EndInterrupt

#########################################################################################################################################################################
####################################          Начальные установки для определения основной погрешности установки выходного тока ########################################################

Interrupt before IDC_L_CH2 first_in_script
     # Перевод нагрузки в режим СC
          DriverSet LOAD_MODEL MODE = CC
     # Установить на источнике переменного напряжения значение стандартного напряжения питания (на случай ранее проведенных изменений)
          DriverSet POWER_SUPPLY V = U_pit
     # Установка диапазона для амперметра
          If I_max <= 30
               DriverSet CURRENT_METER Range_IDC = 30                                   #     установка предела измерений амперметра 30А
          Else
               DriverSet CURRENT_METER Range_IDC = 300                                   #     установка предела измерений амперметра 300А
          Endif
     # Установка выходного напряжения источника     
          DriverSet LOAD_MODEL Load = Off
          math mem_2100 = mem_2001 * U2_max
          If Interface = true
               DriverSet Model_SI_Driver VDC = mem_2100                                                                                                            # для удаленно управляемого источника
          else
               message "На поверяемом источнике установите режим стабилизации по току (СC) и переключите в диапазон Low"          # для источника без интерфейса
               message "На поверяемом источнике установите максимальное значение выходного напряжения для диапазона Low"          # для источника без интерфейса
          endif
     # Установка тока нагрузки     
          DriverSet LOAD_MODEL Load = On                                                  #     Включение нагрузки
          math mem_3998 = mem_3999 * I2_max
          call TOK_NAGRUZKI
EndInterrupt

#########################################################################################################################################################################
#############          Начальные установки для определения основной погрешности измерения выходного тока          #################################################################

Interrupt before IDC_izm_L_CH2  first_in_script
     If Interface = true
     DriverSet Model_SI_Driver channel = 2
	DriverSet Model_SI_Driver RANGE = LOW
 Endif
     # Перевод нагрузки в режим СC
          DriverSet LOAD_MODEL MODE = CC
     # Установить на источнике переменного напряжения значение стандартного напряжения питания (на случай ранее проведенных изменений)
          DriverSet POWER_SUPPLY V = U_pit
     # Установка диапазона для амперметра
          If I_max <= 30
               DriverSet CURRENT_METER Range_IDC = 30                                   #     установка предела измерений амперметра 30А
          Else
               DriverSet CURRENT_METER Range_IDC = 300                                   #     установка предела измерений амперметра 300А
          Endif
     # Установка выходного напряжения источника     
          DriverSet LOAD_MODEL Load = Off
          math mem_3100 = mem_3001 * I2_max
          If Interface = true
               DriverSet Model_SI_Driver     IDC = mem_3100    
          else
               message "На поверяемом источнике установите режим стабилизации по напряжению (СV) и переключите в диапазон Low"          # для источника без интерфейса
               message "На поверяемом источнике установите максимальное значение выходного тока и напряжения для диапазона Low "          # для источника без интерфейса
          endif
     # Установка тока нагрузки     
          DriverSet LOAD_MODEL Load = On                                                  #     Включение нагрузки
          math mem_3998 = mem_3999 * I2_max
          call TOK_NAGRUZKI
EndInterrupt

#########################################################################################################################################################################
#############          Начальные установки для определения основной нестабильности выходного тока при изменении напряжения питания          #################################

Interrupt before INSTB_I_Upit_L_CH2 first_in_script
     # Перевод нагрузки в режим СC
          DriverSet LOAD_MODEL MODE = CC
     # Установить на источнике переменного напряжения значение стандартного напряжения питания (на случай ранее проведенных изменений)
          DriverSet POWER_SUPPLY V = U_pit
     # Установка диапазона для амперметра
          If I_max <= 30
               DriverSet CURRENT_METER Range_IDC = 30                                   #     установка предела измерений амперметра 30А
          Else
               DriverSet CURRENT_METER Range_IDC = 300                                   #     установка предела измерений амперметра 300А
          Endif
EndInterrupt

#########################################################################################################################################################################
#############          Начальные установки для определения основной нестабильности выходного тока при изменении напряжения нагрузки          #################################

Interrupt before INSTB_I_Unagr_L_CH2 first_in_script
     # Перевод нагрузки в режим СC
          DriverSet LOAD_MODEL MODE = CC
     # Установить на источнике переменного напряжения значение стандартного напряжения питания (на случай ранее проведенных изменений)
          DriverSet POWER_SUPPLY V = U_pit
     # Установка диапазона для амперметра
          If I2_max <= 30
               DriverSet CURRENT_METER Range_IDC = 30                                   #     установка предела измерений амперметра 30А
          Else
               DriverSet CURRENT_METER Range_IDC = 300                                   #     установка предела измерений амперметра 300А
          Endif
EndInterrupt

#######################################################################################################################################################################################
##########   M   E   M   ###########################################################################################################################################################
#######################################################################################################################################################################################

#mem_1xxx - данные для заполнения таблиц по условиям проведения поверки + номера пунктов "Внешнего осмотра" и "Опробования"
#mem_2xxx - данные для заполнения таблиц по напряжению
#mem_3xxx - данные для заполнения таблиц по току
#mem_4xxx - данные для заполнения таблиц по сопротивлению
#mem_х1xx - данные для заполнения таблиц в отчет